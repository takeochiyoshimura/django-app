(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function asyncGeneratorStep(e,t,i,o,n,s,r){try{var a=e[s](r),d=a.value}catch(e){return void i(e)}a.done?t(d):Promise.resolve(d).then(o,n)}function _asyncToGenerator(e){return function(){var t=this,i=arguments;return new Promise(function(o,n){var s=e.apply(t,i);function r(e){asyncGeneratorStep(s,o,n,r,a,"next",e)}function a(e){asyncGeneratorStep(s,o,n,r,a,"throw",e)}r(void 0)})}}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(){var e=function(){function e(e,t,i,o,n,s,r){var a;this.id=this.$generateGuid(),this.parentId=e,this.nmId=t.nmId,this.enabledForRegion=t.enabledForRegion,this.isImport=t.isImport,this.hasVideo=null!==(a=t.hasVideo)&&void 0!==a&&a,this.picsCount=t.picsCount,this.urlForReccomendations=t.urlForReccomendations,this.delta=this.hasVideo,this.totalSlides=this.picsCount+this.delta,this.adult=i.adult,this.goodsName=i.goodsName,this.brandName=i.brandName,this.catalogLink="",this.deliveryModel=n,this.ponedModel=o,this.videoModel=s,this.statsModel=r,this.currentSlide=0+this.delta,this.imageGaleryShow=!1,this.shouldShowVideo.depends=["nmId","currentSlide","delta"],this.updateCurrentSlide=this.updateCurrentSlide.bind(this),this.onColorChanged=this.onColorChanged.bind(this)}var t=e.prototype;return t.shouldShowVideo=function(){return this.hasVideo&&this.currentSlide-this.delta==-1||this.currentSlide-this.delta==-2},t.init=function(){return this._bindEvents(),this},t.destroy=function(){this._unbindEvents(),this.videoModel.destroy(),this.ponedModel.destroy()},t.onColorChanged=function(e){var t,i,o,n,s=this,r=e.detail,a=r.isDetailsLoaded,d=r.sourceId,l=r.sourceNmId,u=r.selectedNomenclature,h=r.product;if(d==this.parentId&&l==this.nmId){var c=null!==(t=u.hasVideo)&&void 0!==t&&t;!c&&a&&this.nmId===u.nmId||($.observable(this).setProperty({nmId:u.nmId,enabledForRegion:u.enabledForRegion,isImport:u.isImport,hasVideo:u.hasVideo,picsCount:u.picsCount,urlForReccomendations:u.urlForReccomendations,currentSlide:0+c,delta:c,totalSlides:u.picsCount+c,adult:null!==(i=null==h?void 0:h.adult)&&void 0!==i?i:this.adult,goodsName:null!==(o=null==h?void 0:h.goodsName)&&void 0!==o?o:this.goodsName,brandName:null!==(n=null==h?void 0:h.brandName)&&void 0!==n?n:this.brandName}),this.$helper.animationFrameWithMinDelay(50,function(){return s.initCarousel()}))}},t.initCarousel=function(){var e,t,i,o=this,n=document.getElementById(this.id);if(n){if(this.imageCarousel)return 0!==this.imageCarousel.activeIndex&&this.imageCarousel.slideTo(0),this.imageCarousel.update();var s=n.querySelector(".j-sw-images-carousel");null===(e=this.imageCarousel)||void 0===e||e.destroy();var r={slidesPerView:"auto",centeredSlides:!1,spaceBetween:0,watchOverflow:!0,minRatio:1,maxRatio:2,pagination:{el:n.querySelector(".j-pagination"),type:"fraction",renderFraction:function(e,t){return'<span class="'+e+'"></span>/<span class="'+t+'"></span>'}},navigation:{prevEl:n.querySelector(".swiper-button-prev"),nextEl:n.querySelector(".swiper-button-next"),disabledClass:"disabled",lockClass:"hide"},breakpoints:{576:{direction:"horizontal",centeredSlides:!0,slidesPerView:"auto",spaceBetween:24},1024:{direction:"vertical",centeredSlides:!1,zoom:!1,slidesPerView:5,spaceBetween:8},1600:{direction:"vertical",centeredSlides:!1,zoom:!1,slidesPerView:"auto",spaceBetween:8}},on:{init:function(){s.classList.remove("carousel-opacity")},beforeTransitionStart:function(){var e;o.hasVideo&&(null===(e=s.querySelector(".j-wb-video-player"))||void 0===e||e.pause())},click:function(e){var t;if(!o.$isDesktop&&null==e.target.closest(".j-find-similar")){var i=e.target.closest(".swiper-slide");null!=i&&i.classList.contains("slide--video")||o.$adult.proceedIfAdultConfirmed(o.adult,o.showImageGallery,o,parseInt(null!==(t=i.dataset.imageIndex)&&void 0!==t?t:0),e)}}}};null!==(t=wb.global.settings)&&void 0!==t&&null!==(i=t.switches)&&void 0!==i&&i.enableLazyProductSwiper&&(r.lazy={loadPrevNext:!0,loadPrevNextAmount:3}),this.imageCarousel=new Swiper(s,r)}},t.updateCurrentSlide=function(e){var t,i,o;this.currentSlide!=e&&(e>=0&&(null===(t=this.statsModel)||void 0===t||t.sendEvent("Item_Photo_S",{index:e+1})),-2==e&&(null===(i=this.statsModel)||void 0===i||i.sendEvent("Item_Video_Icon_T")),$.observable(this).setProperty({currentSlide:e}),this.shouldShowVideo()?this.videoModel.show():null===(o=this.videoModel.video)||void 0===o||o.pause())},t.showSocialSharePopup=function(){var e=this;this.$moduleLoader.loadModuleAsync("productShareHelper").then(function(t){t.showSocialSharePopup(e.nmId,e.goodsName,e.brandName)})},t.moveToNextSlide=function(){var e=(this.currentSlide+1)%this.totalSlides;this.updateCurrentSlide(e),this.imageCarousel.slideTo(e)},t.moveToPreviousSlide=function(){var e=(this.currentSlide-1+this.totalSlides)%this.totalSlides;this.updateCurrentSlide(e),this.imageCarousel.slideTo(e)},t.slideToVideo=function(){if(this.hasVideo){var e=this.picsCount-1+this.delta;this.imageCarousel.slideTo(e,120*Math.abs(this.imageCarousel.activeIndex-e))}},t.showImageGallery=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t,i){var o,n,s,r,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.imageGaleryShow){e.next=2;break}return e.abrupt("return");case 2:if(null==(null==i?void 0:i.target.closest(".j-find-similar"))){e.next=4;break}return e.abrupt("return");case 4:for(this.imageGaleryShow=!0,e.prev=5,o=this.$moduleLoader.loadModuleAsync("productGalleryViewer"),n=[],s=[],r=0;r<this.picsCount;r++)n.push($.views.helpers.ImageUrl(this.nmId,"big",r+1)),s.push($.views.helpers.ImageUrl(this.nmId,"c246x328",r+1));return e.next=12,o;case 12:e.sent.showGallery(n,s,null!=t?t:this.currentSlide-this.delta,{classList:["goods-photo"],onHide:function(){return a.imageGaleryShow=!1}}),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),console.error(e.t0.message),this.imageGaleryShow=!1;case 20:case"end":return e.stop()}},e,this,[[5,16]])}));return function(t,i){return e.apply(this,arguments)}}(),t.stopVideo=function(){var e;null===(e=this.videoModel)||void 0===e||e.pause()},t._bindEvents=function(){this.$eventBus.addEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.addEventListener("ProductChanged",this.onColorChanged)},t._unbindEvents=function(){this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.removeEventListener("ProductChanged",this.onColorChanged)},_createClass(e,[{key:"template",get:function(){return e.template}}]),e}();window.__spaModuleManager__.register("productCardImageGallery",e)}();

},{}]},{},[1]);
