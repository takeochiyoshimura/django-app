(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(){var e=function(){function e(e,t,i){var n,r,s,o,d;this.id=this.$generateGuid(),this.parentId=e,this.nmId=t.nmId,this.showSize=t.showSize,this.sizes=null!==(n=null===(r=t.sizes)||void 0===r?void 0:r.map(function(e){return e}))&&void 0!==n?n:[],this.sizeTable=null!==(s=null===(o=t.sizeTable)||void 0===o?void 0:o.map(function(e){return e}))&&void 0!==s?s:[],this.selectedChrtId=null===(d=t.selectedSize)||void 0===d?void 0:d.characteristicId,this.showAllSizes=null!=t.selectedSize,this.allSizesShown=null!=t.selectedSize,this.deliveryInfoHelper=i,this.blinkSizes=!1,this.onSizeUpdated=this.onSizeUpdated.bind(this),this.onColorChanged=this.onColorChanged.bind(this),this.onSameProductOpended=this.onSameProductOpended.bind(this)}var t=e.prototype;return t.init=function(){return this._bindEvents(),this},t.destroy=function(){this._unbindEvents()},t.onSizeUpdated=function(e){var t=e.detail,i=t.nmId,n=t.selectedSize;i==this.nmId&&$.observable(this).setProperty({selectedChrtId:n})},t.onColorChanged=function(e){var t,i,n,r,s=this,o=e.detail,d=o.sourceId,a=o.sourceNmId,l=o.selectedNomenclature;d==this.parentId&&a==this.nmId&&($.observable(this).setProperty({nmId:l.nmId,showSize:l.showSize,selectedChrtId:null===(t=l.selectedSize)||void 0===t?void 0:t.characteristicId,showAllSizes:null!=l.selectedSize,allSizesShown:null!=l.selectedSize,blinkSizes:!1}),$.observable(this.sizeTable).refresh(null!==(i=null===(n=l.sizeTable)||void 0===n?void 0:n.map(function(e){return e}))&&void 0!==i?i:[]),$.observable(this.sizes).refresh(null!==(r=l.sizes)&&void 0!==r?r:[]),this.$helper.nextTick().then(function(){return s.checkSizeList()}))},t.onSameProductOpended=function(e){var t,i,n=e.detail,r=n.sourceId,s=n.sourceNmId,o=n.selectedSize;r==this.parentId&&s==this.nmId&&o!=this.selectedChrtId&&(o||this.showSize||(o=null===(t=this.sizes)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:i.characteristicId),this.$eventBus.dispatchEvent(new CustomEvent("ProductSizeUpdated",{detail:{nmId:this.nmId,selectedSize:o}})))},t.updateSize=function(e){var t=$.view(e.currentTarget).data;t&&this.$eventBus.dispatchEvent(new CustomEvent("ProductSizeUpdated",{detail:{nmId:this.nmId,selectedSize:t.characteristicId}}))},t.validateSize=function(){return!this.showSize||null!=this.selectedChrtId},t.blinkSize=function(){$.observable(this).setProperty({blinkSizes:!0})},t.removeBlink=function(){$.observable(this).setProperty({blinkSizes:!1})},t.toggleSizes=function(){$.observable(this).setProperty({showAllSizes:!1,allSizesShown:!0})},t.checkSizeList=function(){var e=document.getElementById(this.id);null!=e&&$.observable(this).setProperty({showAllSizes:e.scrollHeight-e.clientHeight>40})},t.showTableOfSizes=function(){var e=this,t=_toArray(this.sizeTable),i=t[0],n=t.slice(1),r=Object.values(this.sizes).reduce(function(e,t){return(e[t.characteristicId]={chrtId:t.characteristicId,sizeName:t.sizeName})&&e},{});n=n.filter(function(e){return null!=r[e.chrtId]}),this.$moduleLoader.loadModuleAsync("sizeTable").then(function(t){t.showSizeTablePopup({nmId:e.nmId,selectedSize:e.sizes.find(function(t){return t.characteristicId==e.selectedChrtId}),headCells:i,bodyCells:n,sizeDictionary:r,statCardWba:e.statCardWba})})},t._bindEvents=function(){this.$eventBus.addEventListener("ProductSizeUpdated",this.onSizeUpdated),this.$eventBus.addEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.addEventListener("ProductChanged",this.onColorChanged),this.$eventBus.addEventListener("SameProductOpened",this.onSameProductOpended)},t._unbindEvents=function(){this.$eventBus.removeEventListener("ProductSizeUpdated",this.onSizeUpdated),this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.removeEventListener("ProductChanged",this.onColorChanged),this.$eventBus.removeEventListener("SameProductOpened",this.onSameProductOpended)},_createClass(e,[{key:"template",get:function(){return e.template}}]),e}();window.__spaModuleManager__.register("productCardSizes",e)}();

},{}]},{},[1]);
