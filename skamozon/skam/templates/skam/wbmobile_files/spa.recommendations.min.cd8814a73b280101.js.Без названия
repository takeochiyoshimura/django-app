(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,r)}return o}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(o),!0).forEach(function(t){_defineProperty(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function asyncGeneratorStep(e,t,o,r,n,s,i){try{var a=e[s](i),l=a.value}catch(e){return void o(e)}a.done?t(l):Promise.resolve(l).then(r,n)}function _asyncToGenerator(e){return function(){var t=this,o=arguments;return new Promise(function(r,n){var s=e.apply(t,o);function i(e){asyncGeneratorStep(s,r,n,i,a,"next",e)}function a(e){asyncGeneratorStep(s,r,n,i,a,"throw",e)}i(void 0)})}}$.views&&$.views.tags({recommendations:{dataBoundOnly:!0,mainElement:".j-b-recommended-goods-wrapper",displayElement:".j-b-recommended-goods-wrapper",template:'<div class="j-b-recommended-goods-wrapper"></div>',onUpdate:!1,getOptions:function(){var e,t,o,r,n={type:this.tagCtx.props.type,markupBlock:this.tagCtx.props.markupBlock,nmIds:this.tagCtx.props.nmIds,products:this.tagCtx.props.goods,title:this.tagCtx.props.title,isFinishLook:this.tagCtx.props.isFinishLook,fillPrices:this.tagCtx.props.fillPrices,loop:!!this.tagCtx.props.hasOwnProperty("circular")&&this.tagCtx.props.circular,slideMoveMode:null!==(e=this.tagCtx.props.slideMoveMode)&&void 0!==e?e:"visible",needDenom:null===(t=this.tagCtx.props.needDenom)||void 0===t||t,seeAllUrl:this.tagCtx.props.seeAllUrl,sameWindow:null===(o=this.tagCtx.props.sameWindow)||void 0===o||o,fetchUrl:this.tagCtx.props.fetchUrl,isSimilarByNm:this.tagCtx.props.isSimilarByNm,isSimilarByRecent:this.tagCtx.props.isSimilarByRecent,isRecommendedByNm:this.tagCtx.props.isRecommendedByNm,isAlsoBuyByNm:this.tagCtx.props.isAlsoBuyByNm,analiticsCode:this.tagCtx.props.analiticsCode,analiticsTerm:this.tagCtx.props.analiticsTerm,loadItemsCustom:this.tagCtx.props.loadItemsCustom,onCarouselShow:this.tagCtx.props.onCarouselShow,onScrollTo:this.tagCtx.props.onScrollTo,onlyPopup:this.tagCtx.props.onlyPopup,popupDisableFullButton:this.tagCtx.props.popupDisableFullButton,showRating:this.tagCtx.props.showRating,showRatingNull:this.tagCtx.props.showRatingNull,showDelivery:this.tagCtx.props.showDelivery,showButtons:this.tagCtx.props.showButtons,showButtonBasket:this.tagCtx.props.showButtonBasket,onVoteClick:this.tagCtx.props.onVoteClick,onSeeAllClick:this.tagCtx.props.onSeeAllClick,onItemClick:this.tagCtx.props.onItemClick,onBasketClick:this.tagCtx.props.onBasketClick,onPonedClick:this.tagCtx.props.onPonedClick,updateAnalytics:this.tagCtx.props.updateAnalytics,swiperThreshold:this.tagCtx.props.swiperThreshold,showAllSeparate:null!==(r=this.tagCtx.props.showAllSeparate)&&void 0!==r&&r,userInfo:this.tagCtx.props.userInfo,seeAllDisabled:this.tagCtx.props.seeAllDisabled,httpMethod:this.tagCtx.props.httpMethod,noProcessResponse:this.tagCtx.props.noProcessResponse,xData:this.tagCtx.props.xData,useLight:this.tagCtx.props.useLight};this.tagCtx.props.visible&&(n.visibleCount=this.tagCtx.props.visible),this.tagCtx.props.cod1S&&(n.cod1S=this.tagCtx.props.cod1S),this.tagCtx.props.targetUrl&&(n.target=this.tagCtx.props.targetUrl);var s={};for(var i in this.tagCtx.props)this.tagCtx.props.hasOwnProperty(i)&&0===i.indexOf("query_")&&(s[i.split("query_")[1]]=this.tagCtx.props[i]);return n.query=s,n},init:function(){var e=this;if(!this.inited)return this.inited=!0,this.ctx.root.$moduleLoader.loadModuleAsync("recommendationCarousel",!1).then(function(t,o){var r=e.getOptions();e.recommendationsCarousel=new t(e.mainElem[0],r).showWhenInViewPortAsync()})},onUnbind:function(){var e;null===(e=this.recommendationsCarousel)||void 0===e||e.destroy()}},basketRecommendations:{baseTag:"recommendations",init:function(e){var t,o=this;if(e.props.enabled){var r=e.props.nmIds.join(","),n=[];e.props.loadItemsCustom=(t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r,s,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.nmIds&&0!==t.nmIds.length){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,o.ctx.root.$moduleLoader.loadModuleAsync("basketRecommendationService");case 4:return r=e.sent,s=new r({userInfo:t.userInfo}),e.next=8,s.get(t.nmIds);case 8:if(0!==(i=n=e.sent).length){e.next=11;break}return e.abrupt("return",{goods:[]});case 11:return e.next=13,wb.xnm.getGoodsForRecommend(i,!1,!0,!0,!0);case 13:return a=e.sent,e.abrupt("return",{goods:a});case 15:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),e.props.showRatingNull=!0,e.props.showRating=!0,e.props.showButtons=!0,e.props.onlyPopup=!0,e.props.popupDisableFullButton=!0,e.props.swiperThreshold=24,e.props.showDelivery=!0;var s=function(e){o.ctx.root.$analitic.sendEvent(e,{cart_id:n.join(","),parent_id:r})},i=function(e){return _objectSpread({lw:"CR",targetUrl:e.targetUrl},o.ctx.root.$analitic.getState())};e.props.onBasketClick=function(e){var t,r=document.querySelector(".j-basket-form__content"),n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,s=r.scrollHeight,a=$.view(e.target).data;o.ctx.root.$moduleLoader.loadModuleAsync("basketAdderHelper").then(function(e){e.addToBasket(a,i(a),{basketCustomEvent:function(){var e=r.scrollHeight-s;document.documentElement.scrollTop=n+e;var o=document.querySelector(".popup-list-of-sizes");o&&(t=t||o.offsetTop,o.style.top="".concat(t+e,"px"))}}).then(function(e){e.isSuccess&&$.observable(a).setProperty({addedToBasket:!0})})})},e.props.onPonedClick=function(e){var t=$.view(e.target).data;o.ctx.root.$moduleLoader.loadModuleAsync("basketAdderHelper").then(function(e){e.addToPoned(t,i(t)).then(function(e){e.isSuccess&&$.observable(t).setProperty({addedToPoned:!0})})})},"m"!=wb.settings.displayMode&&(e.props.onVoteClick=function(e){var t=JSON.parse(e.target.dataset.like);s(t?"Cart_Carousel_Recommendations_Like":"Cart_Carousel_Recommendations_Dislike"),$.observable(this).setProperty("voted",!0)}),e.props.onItemClick=function(){s("Cart_Carousel_Recommendations_T",this.settings)};var a=this;e.props.updateAnalytics=function(e){var t=$.view(e.target).data,o=this.goods.findIndex(function(e){return e==t})+1,n=this.analiticsCode;a.ctx.root.$analitic.updateState({iid:o,extraL:n,t:r})};var l=e.props.onCarouselShow;e.props.onCarouselShow=function(){"function"==typeof l&&l(),s("Cart_Carousel_Recommendations_S",this.settings)}}},onAfterLink:function(){var e=this;this.showWhenInViewPortAsync(_asyncToGenerator(regeneratorRuntime.mark(function t(){var o,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ctx.root.$analitic.sendEvent("Cart_Carousel_Recommendations_M",{}),e.tagCtx.props.enabled){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.ctx.root.$moduleLoader.loadModuleAsync("recommendationCarousel",!1);case 5:return o=t.sent,r=e.getOptions(),e.recommendationsCarousel=new o(e.mainElem[0],r),t.next=10,e.recommendationsCarousel.showAsync();case 10:t.sent&&e.bindResize();case 12:case"end":return t.stop()}},t)})))},showWhenInViewPortAsync:function(e){var t=this;if(this.ctx.root.$apiSupport.intersectionObserver)this.observer=new IntersectionObserver(function(o,r){o.forEach(function(o){var n=o.isIntersecting,s=o.intersectionRatio;(n||s>0)&&(e(),r.unobserve(t.mainElem[0]))})},{rootMargin:"-72px"}),this.observer.observe(this.mainElem[0]);else{var o=this.mainElem[0].getBoundingClientRect().top;document.documentElement.clientHeight>o?e():(this._onScrollLoad=this.ctx.root.$helper.throttle(function(){window.pageYOffset>=o-500&&(window.removeEventListener("scroll",t._onScrollLoad),e())},300),window.addEventListener("scroll",this._onScrollLoad))}return this},bindResize:function(){var e=this;"m"==wb.settings.displayMode&&(this._onResize=this.ctx.root.$helper.throttle(function(){var t=e.mainElem[0].querySelector(".goods-slider__list");if(t){var o=$.view(t).data;t.scrollWidth>t.clientWidth?$.observable(o).setProperty({seeAllDisabled:!1}):$.observable(o).setProperty({seeAllDisabled:!0})}},300),window.addEventListener("resize",this._onResize),this._onResize())},onUnbind:function(){this.observer&&this.observer.unobserve(this.mainElem[0]),window.removeEventListener("scroll",this._onScrollLoad),window.removeEventListener("resize",this._onResize)}},promotions:{dataBoundOnly:!0,mainElement:".j-b-recommended-goods-wrapper",displayElement:".j-b-recommended-goods-wrapper",template:'<div class="j-b-recommended-goods-wrapper"></div>',onUpdate:!1,init:function(){var e=this;if(!this.inited)return this.inited=!0,(this.ctx.root.$moduleLoader||this.ctx.root.router.$moduleLoader).loadModuleAsync("recommendationCarousel").then(function(t,o){var r,n,s={title:e.tagCtx.props.title,isPromo:!0,sendStats:!0,loop:!1,slideMoveMode:e.tagCtx.props.slideMoveMode,seeAllUrl:e.tagCtx.props.seeAllUrl,sameWindow:null===(r=e.tagCtx.props.sameWindow)||void 0===r||r,fetchUrl:e.tagCtx.props.fetchUrl,analiticsCode:e.tagCtx.props.analiticsCode,showAllSeparate:null!==(n=e.tagCtx.props.showAllSeparate)&&void 0!==n&&n,httpMethod:e.tagCtx.props.httpMethod};e.tagCtx.props.visible&&(s.visibleCount=e.tagCtx.props.visible),e.tagCtx.props.targetUrl&&(s.target=e.tagCtx.props.targetUrl);var i={};for(var a in e.tagCtx.props)e.tagCtx.props.hasOwnProperty(a)&&0===a.indexOf("query_")&&(i[a.split("query_")[1]]=e.tagCtx.props[a]);s.query=i,e.recommendationsCarousel=new t(e.mainElem[0],s).showWhenInViewPortAsync()})},onUnbind:function(){var e;null===(e=this.recommendationsCarousel)||void 0===e||e.destroy()}},swiperRecommendationCarousel:{recommendationsBreakpointMap:{full:{1024:{spaceBetween:30,slidesPerGroup:5},1310:{spaceBetween:30,slidesPerGroup:6},1520:{spaceBetween:30,slidesPerGroup:7}},light:{1024:{spaceBetween:30,slidesPerGroup:3},1120:{spaceBetween:30,slidesPerGroup:4},1360:{spaceBetween:30,slidesPerGroup:5}}},init:function(){this.options=this.tagCtx.props,this.swiper=null},onUpdate:!1,onAfterLink:function(){var e=this;return _asyncToGenerator(regeneratorRuntime.mark(function t(){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ctx.root.$helper.nextTick();case 2:o=e.ctx.root.$apiSupport.nativeLazyImage,e.swiper=new Swiper(e.linkCtx.elem.querySelector(".j-carousel .swiper-container"),{slidesPerView:"auto",spaceBetween:8,watchOverflow:"true",watchSlidesProgress:!o,watchSlidesVisibility:!o,lazy:!o&&{loadPrevNextAmount:5,loadOnTransitionStart:!0},navigation:{nextEl:e.linkCtx.elem.querySelector(".j-carousel .swiper-button-next"),prevEl:e.linkCtx.elem.querySelector(".j-carousel .swiper-button-prev")},breakpoints:e.linkCtx.data.useLight?e.recommendationsBreakpointMap.light:e.recommendationsBreakpointMap.full,on:{imagesReady:function(){o&&e.linkCtx.elem.querySelectorAll("img[data-src]").forEach(function(e){e.setAttribute("loading","lazy"),e.src=e.dataset.src})}},threshold:e.options.swiperThreshold});case 4:case"end":return t.stop()}},t)}))()},onUnbind:function(){var e;null===(e=this.swiper)||void 0===e||e.destroy()}},nativeRecommendationCarousel:{init:function(){this.lazyLoader=null},onAfterLink:function(){var e=this;return _asyncToGenerator(regeneratorRuntime.mark(function t(){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ctx.root.$moduleLoader.loadModuleAsync("lazyImageLoader");case 2:o=t.sent,e.lazyLoader=new o(e.linkCtx.elem,{rootMargin:"0px 500px",root:e.linkCtx.elem});case 4:case"end":return t.stop()}},t)}))()},onUnbind:function(){var e;null===(e=this.lazyLoader)||void 0===e||e.destroy()}}});

},{}]},{},[1]);
