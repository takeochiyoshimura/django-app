(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";$.fn.draggable=function(t,e){var n=this,o=$(t),i=0,c=0;function u(t){t.preventDefault(),i=t.clientX,c=t.clientY,$(document).on("mousemove",f).on("mouseup",l)}function f(t){t.preventDefault();var e=n[0].offsetTop-c+t.clientY,o=n[0].offsetLeft-i+t.clientX,u=function(t,e){var o=n[0].getBoundingClientRect(),u=document.documentElement.clientWidth||document.body.clientWidth||window.innerWidth,f=(document.documentElement.clientHeight||document.body.clientHeight||window.innerHeight,!0),l=!0;return o.top<0&&e<=c&&(f=!1),(o.left<0&&t<=i||o.right>u&&t>=i)&&(l=!1),{modifyTop:f,modifyLeft:l}}(t.clientX,t.clientY);u.modifyTop&&(n[0].style.top=e+"px"),u.modifyLeft&&(n[0].style.left=o+"px"),i=t.clientX,c=t.clientY}function l(t){t.preventDefault(),$(document).off("mousemove",f).off("mouseup",l),$.isFunction(e)&&e(n[0].style.left,n[0].style.top)}return o.on("mousedown",u),this};

},{}],2:[function(require,module,exports){
"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function asyncGeneratorStep(t,e,n,i,r,s,o){try{var a=t[s](o),h=a.value}catch(t){return void n(t)}a.done?e(h):Promise.resolve(h).then(i,r)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var s=t.apply(e,n);function o(t){asyncGeneratorStep(s,i,r,o,a,"next",t)}function a(t){asyncGeneratorStep(s,i,r,o,a,"throw",t)}o(void 0)})}}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}!function(){require("./draggable");var t=function(){function t(t){var e=t.auth,n=t.uid;this.inited=!1,this.uid=n,this.isAuth=e,this.chatWrapper=document.querySelector(".j-chat-wrap"),this._lazyCheckBounds=this.$helper.debounce(this._checkBounds.bind(this),200),this._updateSettingsFromEvent=this._updateSettingsFromEvent.bind(this),this.onType=this.onType.bind(this),this._onAuthLogin=this._onAuthLogin.bind(this),this._onUnAuthLogin=this._onUnAuthLogin.bind(this)}var e=t.prototype;return e.init=function(){var t=this;return document.addEventListener("click",this.$helper.delegator(".j-btn-chat-open",function(e,n){t._toggleChat(),t.$analitic.sendEvent(n.hasAttribute("data-header")?"Support_Chat_Header_T":"Support_Chat_T")})),this},e.start=function(t){return this.inited?this._refreshChatAsync():this._startChatAsync(t)},e.restart=function(t){var e=t.auth,n=t.uid;this.destroy(),this.isAuth=e,this.uid=n,wb.displayModeSettings.removeObserver(this.onBreakpoint),wb.displayModeSettings.addObserver(this.onBreakpoint.bind(this),!0)},e.destroy=function(){this.inited&&(this.inited=!1,this._unbindEvents(),this.chatWrapper.classList.add("hide"),document.querySelectorAll(".j-btn-chat-open").forEach(function(t){t.classList.add("hide")}),document.body.classList.remove("body--chat-overflow"),$(this.chatWrapper).unlink(),this.onlineChat.stopChat())},e.minimize=function(){this._updateSetting("show",!1),document.querySelector(".j-smm-fixed").classList.remove("smm-fixed--index"),"m"===wb.settings.displayMode&&document.body.classList.remove("body--chat-overflow"),this.chatWrapper.style.display="none"},e.onType=function(t){var e=t.detail,n=e.currentType,i=e.isInit;if("m"==wb.settings.displayMode)return"home"!=n?this.destroy():this.inited?void 0:this.start({ignoreShow:!i})},e.onBreakpoint=function(t){"m"===t?this._addMobileMenuHandler():(this._removeMobileMenuHandler(),this.start())},e._addMobileMenuHandler=function(){this.$eventBus.addEventListener("MobileMenuTypeChange",this.onType)},e._removeMobileMenuHandler=function(){this.$eventBus.removeEventListener("MobileMenuTypeChange",this.onType)},e._startChatAsync=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,n,i,r,s=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:{},n=e.ignoreShow,t.next=3,this.$moduleLoader.loadModuleAsync("onlineChat");case 3:return i=t.sent,this.onlineChat=new i(this.isAuth,this.uid),t.next=7,this.onlineChat.initAsync();case 7:if(t.sent){t.next=9;break}return t.abrupt("return");case 9:this.inited=!0,this.template.link(this.chatWrapper,this),this._bindEvents(),this.chat=document.querySelector(".chat"),this.onlineChat.init(this.chatWrapper,this.chat),(r=this._getSettings())&&(!n&&r.show&&(this.chatWrapper.classList.remove("hide"),document.querySelector(".j-smm-fixed").classList.add("smm-fixed--index"),"m"===wb.settings.displayMode&&document.body.classList.add("body--chat-overflow"),this._removeUnread()),r.unread&&!r.show&&this._showUnread(),r.x&&(this.chat.style.left=r.x),r.y&&(this.chat.style.top=r.y),r.show&&(this._lazyCheckBounds(),this.onlineChat.scrollToBottom()));case 16:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),e._refreshChatAsync=function(){return this.onlineChat.refreshAsync()},e._getSettings=function(){var t,e;return null!==(t=null!==(e=this._tryGetSettingsFromLocalStorage())&&void 0!==e?e:this._tryGetSettingsFromCookie())&&void 0!==t?t:{}},e._tryGetSettingsFromLocalStorage=function(){return localStorage.getObject("wb_chat_settings")},e._tryGetSettingsFromCookie=function(){var t=wb.cookieHelper.getCookie("_wbchat");if(!(t&&t.length>0))return null;try{var e=JSON.parse(t);return this._saveSettings(e),e}catch(t){return null}},e._saveSettings=function(t){localStorage.putObject("wb_chat_settings",t)},e._updateSetting=function(t,e){var n=this._getSettings();n[t]=e,this._saveSettings(n)},e._updateSettingsFromEvent=function(t){var e=t.detail;if(Array.isArray(e)){var n=this._getSettings();e.forEach(function(t){var e=_slicedToArray(t,2),i=e[0],r=e[1];return n[i]=r}),this._saveSettings(n)}},e._bindEvents=function(){var t=this;document.querySelectorAll(".j-btn-chat-open").forEach(function(t){t.classList.remove("hide")}),window.addEventListener("resize",this._lazyCheckBounds),window.addEventListener("scroll",this._lazyCheckBounds),this.$eventBus.addEventListener("UpdateOnlineChatSettings",this._updateSettingsFromEvent),this.$eventBus.addEventListener("OnlineChatShowUnread",this._showUnread),this.$eventBus.addEventListener("onUserAuth",this._onAuthLogin),this.$eventBus.addEventListener("onUserUnAuth",this._onUnAuthLogin),$(".chat").draggable(".j-chat-header",function(e,n){t._updateSetting("x",e),t._updateSetting("y",n)})},e._unbindEvents=function(){window.removeEventListener("resize",this._lazyCheckBounds),window.removeEventListener("scroll",this._lazyCheckBounds),this.$eventBus.removeEventListener("UpdateOnlineChatSettings",this._updateSettingsFromEvent),this.$eventBus.removeEventListener("OnlineChatShowUnread",this._showUnread),this.$eventBus.removeEventListener("onUserAuth",this._onAuthLogin),this.$eventBus.removeEventListener("onUserUnAuth",this._onUnAuthLogin)},e._onAuthLogin=function(){this.restart({auth:!0})},e._onUnAuthLogin=function(){this.restart({auth:!1,uid:this.$services.sessionService.getBasketUid()})},e._checkBounds=function(){var t=this.chat.getBoundingClientRect(),e=document.documentElement.clientWidth||document.body.clientWidth||window.innerWidth,n=document.documentElement.clientHeight||document.body.clientHeight||window.innerHeight;(t.top<0&&0==window.scrollY||t.top+t.height/2>n)&&(this.chat.style.top="",this._updateSetting("y",void 0)),(t.left<-10||t.right>e+10)&&(this.chat.style.left="",this._updateSetting("x",void 0))},e._toggleChat=function(){if(this.inited){this._toggleElem(this.chatWrapper);var t=document.querySelector(".j-smm-fixed");t.classList.contains("smm-fixed--index")?t.classList.remove("smm-fixed--index"):t.classList.add("smm-fixed--index"),"m"===wb.settings.displayMode&&(document.body.classList.contains("body--chat-overflow")?document.body.classList.remove("body--chat-overflow"):document.body.classList.add("body--chat-overflow"));var e=this.chat.isVisible();return this._updateSetting("show",e),e&&(this._lazyCheckBounds(),this._removeUnread()),this.onlineChat.scrollToBottom(),!1}},e._toggleElem=function(t){t.isVisible()?(t.classList.add("hide"),t.style.display="none"):(t.classList.remove("hide"),t.style.display="block")},e._showUnread=function(){document.querySelector(".smm-fixed").classList.add("isWbMessage")},e._removeUnread=function(){this._updateSetting("unread",!1),document.querySelector(".smm-fixed").classList.remove("isWbMessage")},_createClass(t,[{key:"template",get:function(){return t.template}}]),t}();window.__spaModuleManager__.register("onlineChatPopup",t)}();

},{"./draggable":1}]},{},[2]);
