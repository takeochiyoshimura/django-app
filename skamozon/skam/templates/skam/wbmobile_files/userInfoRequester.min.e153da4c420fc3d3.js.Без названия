(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function ownKeys(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,t)}return n}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(n),!0).forEach(function(r){_defineProperty(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _defineProperty(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function asyncGeneratorStep(e,r,n,t,o,s,a){try{var c=e[s](a),i=c.value}catch(e){return void n(e)}c.done?r(i):Promise.resolve(i).then(t,o)}function _asyncToGenerator(e){return function(){var r=this,n=arguments;return new Promise(function(t,o){var s=e.apply(r,n);function a(e){asyncGeneratorStep(s,t,o,a,c,"next",e)}function c(e){asyncGeneratorStep(s,t,o,a,c,"throw",e)}a(void 0)})}}!function(){var e="/webapi/personalinfo",r=WbSpaModel.prototype.$httpClient,n=WbSpaModel.prototype.$verificationTokenHelper,t=function(){function t(){}return t.loadBasicInfo=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t,o){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.fetchJSON("".concat(e),{method:"POST"});case 3:s=n.sent,$.observable(t).setAllProperty(s),t.maskedInfo=s.maskedInfo,n.next=13;break;case 8:n.prev=8,n.t0=n.catch(0),!n.t0.isCancelled&&console.error(n.t0),$.observable(t).setProperty({isAuthenticated:"0"!=WbSpaModel.prototype.$user.getId()}),o?$.observable(t).setProperty(o):$.observable(t).setProperty({inn:1,isUnknownUser:!0,userPhotoLink:"https://images.wbstatic.net/img/0/medium/PersonalPhoto.png",firstName:"Неизвестно",lastName:"Неизвестно"});case 13:return n.prev=13,n.abrupt("return",t);case 16:case"end":return n.stop()}},n,null,[[0,8,13,16]])}));return function(e,r){return n.apply(this,arguments)}}(),t.loadExtraInfo=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t){var o,s,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,WbSpaModel.prototype.$user.getWbxId();case 3:return o=n.sent,n.next=6,r.fetchJSON("".concat(e,"/extrainfo"),{method:"POST"},{redirectUnauth:!0});case 6:if(s=n.sent,!o){n.next=14;break}return n.next=10,WbSpaModel.prototype.$services.groupedDeliveriesService.getPurchaseInfo();case 10:a=n.sent,s.discountInfo||(s.discountInfo={}),s.discountInfo.purchase=a.purchase,s.discountInfo.purchasePercent=a.purchasePercent;case 14:$.observable(t).setAllProperty(_objectSpread({isNetworkError:!1,dataLoaded:!0},s)),n.next=22;break;case 17:n.prev=17,n.t0=n.catch(0),!n.t0.isCancelled&&!n.t0.isUnauthorize&&console.error(n.t0),$.observable(t).setProperty({isNetworkError:!0});case 22:return n.prev=22,n.abrupt("return",t);case 25:case"end":return n.stop()}},n,null,[[0,17,22,25]])}));return function(e){return n.apply(this,arguments)}}(),t.updateFioAsync=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t,o,s,a){var c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.fetchJSON("".concat(e,"/fio"),{method:"PATCH",body:JSON.stringify({firstName:t,lastName:o,middleName:s}),headers:{"Content-Type":"application/json"}},{noProcessResponse:!0});case 2:return c=n.sent,n.abrupt("return",new Promise(function(e){$.processResponse(c,function(r){var n,c;$.observable(a).setProperty({firstName:t,lastName:o,middleName:s,fullName:null===(n="".concat(o||""," ").concat(t||""," ").concat(s||""))||void 0===n?void 0:n.trim(),initials:null!==(c=null==t?void 0:t.slice(0,1))&&void 0!==c?c:""}),e({isSuccess:!0})},function(r){e({isSuccess:!1,error:r})})}));case 4:case"end":return n.stop()}},n)}));return function(e,r,t,o){return n.apply(this,arguments)}}(),t.updateSexAsync=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t,o){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.fetchJSON("".concat(e,"/sex"),{method:"PATCH",body:new URLSearchParams({sex:t})},{noProcessResponse:!0});case 2:return s=n.sent,n.abrupt("return",new Promise(function(e){$.processResponse(s,function(r){$.observable(o).setProperty({genderE:t}),e({isSuccess:!0})},function(r){e({isSuccess:!1,error:r})})}));case 4:case"end":return n.stop()}},n)}));return function(e,r){return n.apply(this,arguments)}}(),t.updateBirthdayAsync=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t,o){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.fetchJSON("".concat(e,"/birthday"),{method:"PATCH",body:new URLSearchParams({birthdayDate:t})},{noProcessResponse:!0});case 2:return s=n.sent,n.abrupt("return",new Promise(function(e){$.processResponse(s,function(r){$.observable(o).setProperty({birthdayDate:t}),e({isSuccess:!0})},function(r){return e({isSuccess:!1,error:r})})}));case 4:case"end":return n.stop()}},n)}));return function(e,r){return n.apply(this,arguments)}}(),t.updateEmailAsync=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t,o){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.fetchJSON("".concat(e,"/email"),{method:"PATCH",body:JSON.stringify({email:t}),headers:{"Content-Type":"application/json"}},{noProcessResponse:!0});case 2:return s=n.sent,n.abrupt("return",new Promise(function(e){$.processResponse(s,function(r){e({isSuccess:!0})},function(r){e({isSuccess:!1,error:r})})}));case 4:case"end":return n.stop()}},n)}));return function(e,r){return n.apply(this,arguments)}}(),t.updatePhoneMobileAsync=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(o,s,a,c){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.fetchJSON("".concat(e,"/phonemobile"),{method:"PATCH",body:JSON.stringify({stage:o,fullPhoneMobile:s,confirmCode:a}),headers:{"Content-Type":"application/json"}},{noProcessResponse:!0});case 2:return i=t.sent,t.abrupt("return",new Promise(function(e){$.processResponse(i,function(r){n.updateVerificationToken(r.newToken),$.observable(c).setProperty({phone:s,formattedPhoneMobile:r.formattedPhoneMobile}),e({isSuccess:!0})},function(r){e({isSuccess:!1,error:r})})}));case 4:case"end":return t.stop()}},t)}));return function(e,r,n,o){return t.apply(this,arguments)}}(),t.updateInnAsync=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t,o){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.fetchJSON("".concat(e,"/inn"),{method:"PATCH",body:JSON.stringify({inn:t}),headers:{"Content-Type":"application/json"}},{noProcessResponse:!0});case 2:return s=n.sent,n.abrupt("return",new Promise(function(e){$.processResponse(s,function(r){$.observable(o).setProperty({inn:t}),e({isSuccess:!0})},function(r){e({isSuccess:!1,error:r})})}));case 4:case"end":return n.stop()}},n)}));return function(e,r){return n.apply(this,arguments)}}(),t.updateImageAsync=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t,o){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.fetchJSON("".concat(e,"/photo"),{method:"PATCH",body:new URLSearchParams({base64Image:t})},{noProcessResponse:!0});case 2:return s=n.sent,n.abrupt("return",new Promise(function(e){$.processResponse(s,function(r){$.observable(o).setProperty({userPhotoLink:r,hasPhoto:!0}),e({isSuccess:!0})},function(r){e({isSuccess:!1,error:r})})}));case 4:case"end":return n.stop()}},n)}));return function(e,r){return n.apply(this,arguments)}}(),t.removeUserPhotoAsync=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.fetchJSON("".concat(e,"/photo"),{method:"DELETE"},{noProcessResponse:!0});case 2:return o=n.sent,n.abrupt("return",new Promise(function(e){$.processResponse(o,function(r){$.observable(t).setProperty({userPhotoLink:r,hasPhoto:!1}),e({isSuccess:!0})},function(r){e({isSuccess:!1,error:r})})}));case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),t}();window.__spaModuleManager__.register("userInfoRequester",t)}();

},{}]},{},[1]);
