(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function asyncGeneratorStep(e,t,r,n,s,i,a){try{var o=e[i](a),u=o.value}catch(e){return void r(e)}o.done?t(u):Promise.resolve(u).then(n,s)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var i=e.apply(t,r);function a(e){asyncGeneratorStep(i,n,s,a,o,"next",e)}function o(e){asyncGeneratorStep(i,n,s,a,o,"throw",e)}a(void 0)})}}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CACHE=new Map,SuggestionsTypes=require("./suggestionsTypes"),SuggestionsExecutor=function(e){function t(t,r){var n;return(n=e.call(this)||this).type=r,n.settings=t,n.requestUrl=null,n}_inheritsLoose(t,e);var r=t.prototype;return r.loadSuggestionsAsync=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r,n,s,i,a,o,u,c,h,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.requestUrl){e.next=4;break}return e.next=3,this._createRequestUrl();case 3:this.requestUrl=e.sent;case 4:if(CACHE.has(this.settings.requestUrl)||CACHE.set(this.settings.requestUrl,new Map),(r=CACHE.get(this.settings.requestUrl)).has(t)){e.next=39;break}if(this.requestUrl.searchParams.set(null!==(n=this.settings.queryName)&&void 0!==n?n:"query",t.trimLeft()),this.type!=SuggestionsTypes.grouped){e.next=17;break}return e.next=11,this._getGender();case 11:s=e.sent,i=wb.settings.currentLocale,a=WbSpaModel.prototype.$helper.currentCulture,this.requestUrl.searchParams.set("gender",s),this.requestUrl.searchParams.set("locale",i),this.requestUrl.searchParams.set("lang",a);case 17:return e.prev=17,e.next=20,this.$httpClient.fetchBasicJSON(this.requestUrl.toString());case 20:return h=e.sent,e.next=23,null===(u=(c=this.settings).dataProceeder)||void 0===u?void 0:u.call(c,h,t);case 23:if(e.t1=o=e.sent,e.t0=null!==e.t1,!e.t0){e.next=27;break}e.t0=void 0!==o;case 27:if(!e.t0){e.next=31;break}e.t2=o,e.next=32;break;case 31:e.t2=h;case 32:p=e.t2,r.set(t,{suggestions:p,type:this.type}),e.next=39;break;case 36:return e.prev=36,e.t3=e.catch(17),e.abrupt("return",null);case 39:return e.abrupt("return",r.get(t));case 40:case"end":return e.stop()}},e,this,[[17,36]])}));return function(t){return e.apply(this,arguments)}}(),r._getGender=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,WbSpaModel.prototype.$getUserGender();case 2:t=e.sent,e.t0=t,e.next="Male"===e.t0?6:"Female"===e.t0?7:8;break;case 6:return e.abrupt("return","male");case 7:return e.abrupt("return","female");case 8:return e.abrupt("return","common");case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),r._createRequestUrl=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=this.settings.requestUrl)||void 0===t){e.next=4;break}e.t0=t,e.next=7;break;case 4:return e.next=6,this.settings.urlCreator();case 6:e.t0=e.sent;case 7:return r=e.t0,e.abrupt("return",new URL(r,wb.settings.fullDomainName||window.location.origin));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t}(WbSpaModel),HistorySuggestionsExcecutor=function(){function e(e){this.historySearchCacheName=e.cacheKey,this.historiesLimit=e.historiesLimit,this._historySearch=null}var t=e.prototype;return t.loadSuggestionsAsync=function(e){var t=this.historySearch;if(e.length>0){var r=e.replace(wb.settings.regexp.escapingRegExp,"\\$&").trim(),n=new RegExp("^".concat(r));t=t.filter(function(e){return e.match(n)})}var s=t.slice(0,5).map(function(t){return{name:t,type:SuggestionsTypes.history,search:t,typedText:e,searchParams:new URLSearchParams({search:t})}});return{type:SuggestionsTypes.history,suggestions:s}},t.saveHistorySearch=function(e){var t=this._makeSafeString(e);this._updateHistorySearch(t)},t.removeFromHistorySearch=function(e,t){t?this.historySearch=[]:e&&(this.historySearch=this.historySearch.filter(function(t){return t!=e}))},t._makeSafeString=function(e){return e.replace(/<\/?[^>]+>/gi,"").trim()},t._getHistorySearchFromCache=function(){var e,t;return null!==(e=null===(t=localStorage)||void 0===t?void 0:t.getObject(this.historySearchCacheName))&&void 0!==e?e:[]},t._putHistorySearchToCache=function(e){var t;e&&(null===(t=localStorage)||void 0===t||t.putObject(this.historySearchCacheName,e))},t._updateHistorySearch=function(e){if(e){var t=this.historySearch,r=t.findIndex(function(t){return t==e});r>=0&&t.splice(r,1),t.unshift(e),t.length>this.historiesLimit&&t.pop(),this.historySearch=t}},_createClass(e,[{key:"historySearch",get:function(){return this._historySearch||(this._historySearch=this._getHistorySearchFromCache()),this._historySearch},set:function(e){var t=this._putHistorySearchToCache(e);this._historySearch=t}}]),e}();function suggestionsExecutorFactory(e,t){switch(t){case SuggestionsTypes.history:return new HistorySuggestionsExcecutor(e);default:return new SuggestionsExecutor(e,t)}}module.exports=suggestionsExecutorFactory;

},{"./suggestionsTypes":3}],2:[function(require,module,exports){
"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var n,o,a=[],i=!0,u=!1;try{for(t=t.call(r);!(i=(n=t.next()).done)&&(a.push(n.value),!e||a.length!==e);i=!0);}catch(r){u=!0,o=r}finally{try{i||null==t.return||t.return()}finally{if(u)throw o}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function asyncGeneratorStep(r,e,t,n,o,a,i){try{var u=r[a](i),s=u.value}catch(r){return void t(r)}u.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(r){return function(){var e=this,t=arguments;return new Promise(function(n,o){var a=r.apply(e,t);function i(r){asyncGeneratorStep(a,n,o,i,u,"next",r)}function u(r){asyncGeneratorStep(a,n,o,i,u,"throw",r)}i(void 0)})}}function _defineProperties(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function _createClass(r,e,t){return e&&_defineProperties(r.prototype,e),t&&_defineProperties(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}!function(){var r=require("./suggestionsTypes"),e=require("./suggestionsExecutor"),t=function(){function t(){this.executors=new Map}var n=t.prototype;return n.addExecutor=function(r,e){this.executors.set(e,r)},n.loadSuggestionsAsync=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,n,o,a,i,u,s=arguments;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null==(t=s.length>1&&void 0!==s[1]?s[1]:null)||!this.executors.has(t)){r.next=5;break}if(null==(n=this.executors.get(t).loadSuggestionsAsync(e))||!n.suggestions.length){r.next=5;break}return r.abrupt("return",[n]);case 5:return r.next=7,Promise.all(this.executors.map(function(r){return r.loadSuggestionsAsync(e)}).toArray());case 7:return o=(o=r.sent).filter(function(r){return null!=r}),(a=o.find(function(r){return 5===r.type}))&&(a=JSON.parse(JSON.stringify(a)),o=o.filter(function(r){return 5!==r.type}),(u=a.suggestions.find(function(r){return 6===r.type}))&&(u.forEmptySearch=!0),(i=o).push.apply(i,_toConsumableArray(a.suggestions))),r.abrupt("return",o.filter(function(r){return null!=r}));case 12:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}(),n.saveHistorySearch=function(e){var t;null===(t=this.executors.get(r.history))||void 0===t||t.saveHistorySearch(e)},n.removeFromHistorySearch=function(e,t){var n;null===(n=this.executors.get(r.history))||void 0===n||n.removeFromHistorySearch(e,t)},t.createSuggestionsHelper=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=new t;return r.forEach(function(r){var t=_slicedToArray(r,2),o=t[0],a=t[1];try{var i=e(o,a);n.addExecutor(i,a)}catch(r){console.error(r)}}),n},_createClass(t,null,[{key:"suggestionsTypes",get:function(){return r}}]),t}();window.__spaModuleManager__.register("suggestionsHelper",t)}();

},{"./suggestionsExecutor":1,"./suggestionsTypes":3}],3:[function(require,module,exports){
"use strict";module.exports=Object.freeze({history:0,catalog:1,brands:2,subjects:3,goods:4,grouped:5,tags:6});

},{}]},{},[2]);
