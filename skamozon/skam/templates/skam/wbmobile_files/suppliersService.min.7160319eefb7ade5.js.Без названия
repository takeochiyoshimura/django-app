(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";var SupplierInfoCache=require("./supplierInfoCache"),BOOKING_SUPPLIERS=[228823,254312,293891,332604,368502,390150,403725,406583,431264,466840,466857,512928,603972,332458],SupplierExtInfo=function(e){var i,t,a;this.rating=e.valuation,this.feedbacks=null!==(i=e.feedbacksCount)&&void 0!==i?i:0,e.ratingIsInvisible||(this.percent=Math.round(10*e.rating)/10),this.registrationDate=e.registrationDate,this.saleItemQuantity=null!==(t=e.saleItemQuantity)&&void 0!==t?t:0,this.hasLogo=e.hasLogo,this.hasBanner=e.hasBanner,this.v=SupplierInfoCache.cacheVersion;var s=wb.helpers.date.diff(new Date(this.registrationDate)),r=s.months,n=s.years;this.isNewSupplier=0==r&&0==n,this.id=e.id,this.hideSellsCount=BOOKING_SUPPLIERS.includes(this.id);var o=null===(a=e.defectPercent)||void 0===a?void 0:a.toFixed(1);o&&(this.defectPercent=parseFloat(o)),this.deliveryDuration=e.deliveryDuration>0?e.deliveryDuration:null};module.exports=SupplierExtInfo;

},{"./supplierInfoCache":3}],2:[function(require,module,exports){
"use strict";function _defineProperties(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var ORG_FORMS=["ООО","ПАО","ОАО","ЗАО","ИП","Фонд","Ассоциации","Союзы","НАО","ТОО","АО"],SupplierInfo=function(){function e(e){var r,t;this.nmId=e.nmId,this.legalAddress=e.legalAddress,this.ogrn=e.ogrn,this.ogrnip=e.ogrnip,this.supplierName=e.supplierName,this.supplierId=e.supplierId,this.trademark=this.isDefaultSupplier?"WILDBERRIES":(null!==(r=e.trademark)&&void 0!==r?r:"").length>0?e.trademark:e.supplierName,this.dt=null!==(t=e.dt)&&void 0!==t?t:Date.now(),this.extInfo=e.extInfo,this.shopName=e.shopName,this.logoUrl=e.logoUrl,this.shopId=e.shopId}return _createClass(e,[{key:"isDefaultSupplier",get:function(){return 32477==this.supplierId||12399==this.supplierId}},{key:"orgForms",get:function(){return ORG_FORMS}}]),e}();module.exports=SupplierInfo;

},{}],3:[function(require,module,exports){
"use strict";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a=[],l=!0,i=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(a.push(n.value),!r||a.length!==r);l=!0);}catch(e){i=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(i)throw o}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var CACHE_VERSION="v5",SUPPLIERS_EXT_CACHE_KEY="suppliersInfo",SUPPLIERS_CACHE_TTL=72e5,SUPPLIERS_CACHE_KEY="product_supliers",MAX_CACHE_AGE=432e6,MAX_CACHE_SIZE=255,MULTISHOP_SUPPLIERS_CACHE_KEY="multiShopSuppliers",MULTISHOP_SUPPLIERS_CACHE_TTL=36e5,SupplierInfoCache=function(){function e(){}return e.getSuppliersFromCache=function(){try{var e,r=Date.now(),t=null!==(e=localStorage.getObject(SUPPLIERS_CACHE_KEY))&&void 0!==e?e:{};return Object.entries(t).filter(function(e){var t=_slicedToArray(e,2);t[0];return t[1].dt+MAX_CACHE_AGE>r}).reduce(function(e,r){var t=_slicedToArray(r,2),n=t[0],o=t[1];return e[n]=o,e},{})}catch(e){return console.error("[ProductSuppliersCache]: failed to read from local storage",e),{}}},e.setSuppliersToCache=function(r){var t=Date.now(),n=e.getSuppliersFromCache(),o=Object.values(n).filter(function(e){return e.dt+MAX_CACHE_AGE>t});o.length>MAX_CACHE_SIZE&&(o=o.slice(0,MAX_CACHE_SIZE));var a=o.reduce(function(e,r){return e[r.nmId]=r,e},{});r.forEach(function(e){return a[e.nmId]=e});try{localStorage.putObject(SUPPLIERS_CACHE_KEY,a)}catch(e){console.error("[ProductSuppliersCache]: failed to save from local storage",e)}},e.getExtFromCache=function(e){var r,t=localStorage.getObject(SUPPLIERS_EXT_CACHE_KEY);if(!t)return null;var n=t[e];return n?Date.now()>(null!==(r=n.t)&&void 0!==r?r:0)||n.v!=CACHE_VERSION?(delete t[e],localStorage.putObject(SUPPLIERS_EXT_CACHE_KEY,t),null):n:null},e.setExtToCache=function(e,r){var t;if(e>0&&r){var n=null!==(t=localStorage.getObject(SUPPLIERS_EXT_CACHE_KEY))&&void 0!==t?t:{};n[e]=_objectSpread(_objectSpread({},r),{},{t:Date.now()+SUPPLIERS_CACHE_TTL}),localStorage.putObject(SUPPLIERS_EXT_CACHE_KEY,n)}},e.getMultishopSuppliersFromCache=function(){var e,r=localStorage.getObject(MULTISHOP_SUPPLIERS_CACHE_KEY);return!r||Date.now()>(null!==(e=r.t)&&void 0!==e?e:0)?null:r.suppliers},e.setMultishopSuppliersToCache=function(e){(null==e?void 0:e.length)>0&&localStorage.putObject(MULTISHOP_SUPPLIERS_CACHE_KEY,{suppliers:e,t:Date.now()+MULTISHOP_SUPPLIERS_CACHE_TTL})},_createClass(e,null,[{key:"cacheVersion",get:function(){return CACHE_VERSION}}]),e}();module.exports=SupplierInfoCache;

},{}],4:[function(require,module,exports){
"use strict";function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,u,i=[],s=!0,a=!1;try{for(t=t.call(e);!(s=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);s=!0);}catch(e){a=!0,u=e}finally{try{s||null==t.return||t.return()}finally{if(a)throw u}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,r,t,n,u,i,s){try{var a=e[i](s),o=a.value}catch(e){return void t(e)}a.done?r(o):Promise.resolve(o).then(n,u)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise(function(n,u){var i=e.apply(r,t);function s(e){asyncGeneratorStep(i,n,u,s,a,"next",e)}function a(e){asyncGeneratorStep(i,n,u,s,a,"throw",e)}s(void 0)})}}!function(){var e=require("./supplierInfo"),r=require("./supplierExtInfo"),t=require("./supplierInfoCache"),n=function(){function n(){}var u=n.prototype;return u.getSellersAsync=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function r(t,n){var u,i,s=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this.suppliersList){r.next=4;break}return r.next=3,this._getMultishopSuppliers();case 3:this.suppliersList=r.sent;case 4:return r.next=6,Promise.all(t.map(function(e){return s._loadBasicSupplierInfoAsync(e,s.suppliersList)}));case 6:if(u=(u=r.sent).filter(function(e){return null!=e}),!n){r.next=13;break}return r.next=11,this.getSuppliersExtInfo(u.map(function(e){return e.supplierId}));case 11:(null==(i=r.sent)?void 0:i.length)>0&&u.forEach(function(e){e.extInfo=i.find(function(r){return(null==r?void 0:r.id)==e.supplierId})});case 13:return r.abrupt("return",u.map(function(r){return new e(r)}));case 14:case"end":return r.stop()}},r,this)}));return function(e,t){return r.apply(this,arguments)}}(),u.getProductSupplierByNmIdsAsync=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function r(n){var u,i,s=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(u=t.getSuppliersFromCache(),i=n.filter(function(e){return null==u[e]}),{},!(i.length>0)){r.next=12;break}if(this.suppliersList){r.next=8;break}return r.next=7,this._getMultishopSuppliers();case 7:this.suppliersList=r.sent;case 8:return r.next=10,Promise.all(i.map(function(e){return s._loadBasicSupplierInfoAsync(e,s.suppliersList)}));case 10:r.sent.forEach(function(e){return null!=e&&(u[e.nmId]=e)});case 12:return t.setSuppliersToCache(Object.values(u)),r.abrupt("return",Object.entries(u).reduce(function(r,t){var n=_slicedToArray(t,2),u=n[0],i=n[1];return r[u]=new e(i),r},{}));case 14:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}(),u.loadBasicSupplierInfoAsync=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.suppliersList){e.next=4;break}return e.next=3,this._getMultishopSuppliers();case 3:this.suppliersList=e.sent;case 4:return e.next=6,this._loadBasicSupplierInfoAsync(r,this.suppliersList);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),u._loadBasicSupplierInfoAsync=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function r(t,n){var u,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.$httpClient.fetchBasicJSON(wb.helpers.url.urlSellerStatic(t),{},{nullOnError:!0});case 3:if(null!=(u=r.sent)){r.next=6;break}return r.abrupt("return",null);case 6:return r.next=8,this._getMultiShopInfo(u.supplierId,t,n);case 8:return(i=r.sent)&&(u.shopName=i.title,u.logoUrl=i.logo_url,u.shopId=i.num),r.abrupt("return",new e(u));case 13:return r.prev=13,r.t0=r.catch(0),console.error(r.t0),r.abrupt("return",null);case 17:case"end":return r.stop()}},r,this,[[0,13]])}));return function(e,t){return r.apply(this,arguments)}}(),u.getSupplierExtInfo=function(e,r){var t,n,u,i;if(32477==e||12399==e)return null;if(!(null!==(t=wb.global.settings)&&void 0!==t&&null!==(n=t.switches)&&void 0!==n&&n.enableSellerPercent&&e>0))return null;var s=null===(u=wb.global.settings)||void 0===u?void 0:null===(i=u.switches)||void 0===i?void 0:i.enablePublicSellerPercent;return this._getSupplierInfo(e,s,r)},u.getSuppliersExtInfo=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,u,i,s,a,o,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&0!=t.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this._removeSuppliersIds(t),null!==(n=wb.global.settings)&&void 0!==n&&null!==(u=n.switches)&&void 0!==u&&u.enableSellerPercent&&0!=t.length){e.next=5;break}return e.abrupt("return",null);case 5:if(null===(i=wb.global.settings)||void 0===i||null===(s=i.switches)||void 0===s||!s.enablePublicSellerPercent){e.next=7;break}return e.abrupt("return",this._getListFromPublic(t));case 7:if(null===(a=wb.global.settings)||void 0===a||null===(o=a.switches)||void 0===o||!o.enableSellerPercent||0==t.length){e.next=12;break}return e.next=10,this.$httpClient.fetchJSON("webapi/spa/product/getsellersinfo?"+t.reduce(function(e,r){return e.append("supplierIds",r),e},new URLSearchParams));case 10:return c=e.sent,e.abrupt("return",c?c.map(function(e){return new r(e)}):null);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),u._removeSuppliersIds=function(e){var r=Array.from(e);return[32477,12399].forEach(function(e){var t=r.indexOf(e);t>-1&&r.splice(t,1)}),r},u._getSupplierInfo=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r,t,n){var u,i,s,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(u=[]).push(t?this._getFromPublic(r):this._getFromInner(r)),n&&u.push(this._loadDeliveryInfoFromProductAsync(n)),e.next=5,Promise.all(u);case 5:return i=e.sent,s=_slicedToArray(i,2),a=s[0],o=s[1],null!=a&&a.deliveryDuration&&o&&(o.deliveryTime=a.deliveryDuration,a.deliveryInfo=o),e.abrupt("return",a);case 11:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}(),u._getMultiShopInfo=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r,t,n){var u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(!((null==n?void 0:n.length)>0&&n.find(function(e){return e.supplier_id==r}))){e.next=10;break}return e.next=5,this.$httpClient.fetchJSON("".concat("/webapi/multishopsupplierinfo/").concat(r,"/").concat(t));case 5:return(u=e.sent)&&(u.supplierId=r,u.nmId=t),e.abrupt("return",Promise.resolve(u));case 10:return e.abrupt("return",Promise.resolve(null));case 11:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}(),u._getMultishopSuppliers=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.getMultishopSuppliersFromCache())){e.next=3;break}return e.abrupt("return",Promise.resolve(r));case 3:return e.prev=3,e.next=6,this.$httpClient.fetchJSON("/webapi/seller/multishopsupplier-list",{},{noProcessResponse:!0});case 6:return n=e.sent,t.setMultishopSuppliersToCache(null==n?void 0:n.value),e.abrupt("return",Promise.resolve(null==n?void 0:n.value));case 11:return e.prev=11,e.t0=e.catch(3),e.abrupt("return",Promise.resolve(null));case 14:case"end":return e.stop()}},e,this,[[3,11]])}));return function(){return e.apply(this,arguments)}}(),u._getFromInner=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$httpClient.fetchJSON(this.$router.urls.productCardSupplierPercent+t);case 2:return n=e.sent,e.abrupt("return",n?new r(n):null);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),u._getFromPublic=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(n){var u,i,s,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u=t.getExtFromCache(n))){e.next=3;break}return e.abrupt("return",1==u.e?null:u);case 3:return e.next=5,fetch("https://suppliers-shipment.wildberries.ru/api/v1/suppliers/"+n,{headers:{"X-Client-Name":"site"}});case 5:if((i=e.sent).ok){e.next=9;break}return 404==i.status&&t.setExtToCache(n,{e:1}),e.abrupt("return",null);case 9:return e.next=11,i.json();case 11:if(s=e.sent,!(Object.keys(null!=s?s:{}).length>0)){e.next=16;break}return a=new r(s),t.setExtToCache(n,a),e.abrupt("return",a);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}},e)}));return function(r){return e.apply(this,arguments)}}(),u._getListFromPublic=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(n){var u,i,s,a,o,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n.reduce(function(e,r){var n=t.getExtFromCache(r);return e.result.set(r,n),!n&&e.uncachedList.push(r),e},{result:new Map,uncachedList:[]}),i=u.result,0!=(s=u.uncachedList).length){e.next=3;break}return e.abrupt("return",i.toArray(function(e){return 1==e.e?null:e}));case 3:return e.prev=3,e.next=6,fetch("https://suppliers-shipment.wildberries.ru/api/v1/suppliers/find_by_ids",{headers:{"X-Client-Name":"site","Content-Type":"application/json"},method:"POST",body:JSON.stringify(s)});case 6:return a=e.sent,e.next=9,a.json();case 9:o=e.sent,c=o.toMap(function(e){return e.id},function(e){return e}),s.forEach(function(e){var n=c.has(e)?new r(c.get(e)):{e:1};i.set(e,n),t.setExtToCache(e,n)}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.error(e.t0);case 17:return e.prev=17,e.abrupt("return",i.toArray(function(e){return 1==e.e?null:e}));case 20:case"end":return e.stop()}},e,null,[[3,14,17,20]])}));return function(r){return e.apply(this,arguments)}}(),u._loadDeliveryInfoFromProductAsync=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r.storeId){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.$moduleLoader.loadServiceAsync("deliveryInfoService");case 5:return e.next=7,this.$services.deliveryInfoService.getStoreById(r.storeId);case 7:if((t=e.sent).isSellerStore){e.next=10;break}return e.abrupt("return",null);case 10:return e.abrupt("return",{isSellerDelivery:t.isDbs,deliveryTime:null});case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",null);case 16:case"end":return e.stop()}},e,this,[[0,13]])}));return function(r){return e.apply(this,arguments)}}(),n}();window.__spaServiceManager__.register("suppliersService",n)}();

},{"./supplierExtInfo":1,"./supplierInfo":2,"./supplierInfoCache":3}]},{},[4]);
