(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";var _excluded=["sourceId","sourceNmId","ancherTarget"];function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,r,n,o,i,s){try{var a=e[i](s),d=a.value}catch(e){return void r(e)}a.done?t(d):Promise.resolve(d).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(e){asyncGeneratorStep(i,n,o,s,a,"next",e)}function a(e){asyncGeneratorStep(i,n,o,s,a,"throw",e)}s(void 0)})}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(){var e=function(){function e(e){var t,r,n;e=null!==(t=null===(r=e)||void 0===r?void 0:r.data)&&void 0!==t?t:e,this.data=e,this.id=this.$generateGuid(),this.renderRecent=!1,this._showRecommendationCarousel=!0,this.analiticState=this.$analitic.getState(),this.deliveryHelper={},this.videoReviews=null,this.statCardWba=null,this.cardCommonActionEventsWba=this.cardCommonActionEventsWba.bind(this),this.cardCommonShowEventsWba=this.cardCommonShowEventsWba.bind(this),this.getVideoReviewsUrl="https://video-reviews.wildberries.ru/api/v1/video-by-nm",this.recommendationUrlHelper.depends=["selectedNomenclature","selectedNomenclature.nmId"],this.showMinAddedOptions.depends=["product"],this.multipleSellersHelper=null,this.priceHistoryHelper=null,this.stickyPanel=null,this.initComments=this.initComments.bind(this),this.currentTab="c",this.articlesCount=0,this.videosCount=0,this.questionsCount=null!==(n=this.questionsCount)&&void 0!==n?n:0,this.unrendered=!1,this.onSizeUpdated=this.onSizeUpdated.bind(this),this.onFavoritesUpdate=this.onFavoritesUpdate.bind(this),this.onColorChanged=this.onColorChanged.bind(this),this.onProductChanged=this.onProductChanged.bind(this),this.getVerifiedCertificateData=this.getVerifiedCertificateData.bind(this),this.getAndClickCertificateLink=this.getAndClickCertificateLink.bind(this)}var t=e.prototype;return t.recommendationUrlHelper=function(){return{alsoBuy:wb.urlHelper.alsoBuyCatalog(this.selectedNomenclature.nmId),similarGoods:"/recommendation/catalog?type=similar&forproduct=".concat(this.selectedNomenclature.nmId,"&excludeNms=true"),recommendedByNm:wb.urlHelper.recommendedByNmCatalog(this.selectedNomenclature.nmId),promo:wb.urlHelper.promoCatalogByNm(this.selectedNomenclature.nmId)}},t.showMinAddedOptions=function(){var e,t,r,n,o=this;return(null===(e=this.selectedNomenclature.minGroupedAddedOptions)||void 0===e?void 0:e.length)>0&&(!!this.selectedNomenclature.minGroupedAddedOptions.some(function(e){var t;return(null===(t=e.addedOptions)||void 0===t?void 0:t.length)>0})&&(this.product.showMinDetails&&((null===(t=this.selectedNomenclature.groupedAddedOptions)||void 0===t?void 0:t.length)!==(null===(r=this.selectedNomenclature.minGroupedAddedOptions)||void 0===r?void 0:r.length)||!(null!==(n=this.selectedNomenclature.minGroupedAddedOptions)&&void 0!==n&&n.every(function(e,t){var r,n;return(null===(r=o.selectedNomenclature.groupedAddedOptions[t])||void 0===r?void 0:null===(n=r.addedOptions)||void 0===n?void 0:n.length)===e.addedOptions.length})))))},t.onBeforeRender=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,o,i,s,a,d,l,c,u,h,p,m,v,f,y,b,g,w,C;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$analitic.updateAnaliticsFromQuery(),this.analiticState=this.$analitic.getState(),n=this.fromSSR?Promise.resolve(null!==(t=null===(r=this.data)||void 0===r?void 0:r.data)&&void 0!==t?t:this.data):this.data.dataTask,e.next=5,Promise.all([n,this.$moduleLoader.loadModuleAsync("suppliersInfoHelper"),this.$moduleLoader.loadModuleAsync("productCardSizes"),this.$moduleLoader.loadModuleAsync("productCardPrice"),this.$moduleLoader.loadModuleAsync("productCardColors"),this.$moduleLoader.loadModuleAsync("productCardOrderGood"),this.$moduleLoader.loadModuleAsync("deliveryInfoHelper"),this.$moduleLoader.loadModuleAsync("productCardPoned"),this.$moduleLoader.loadModuleAsync("productCardImageGallery"),this.$moduleLoader.loadModuleAsync("productCardVideo"),this.$moduleLoader.loadModuleAsync("productCardDescribtionError"),this.$moduleLoader.loadModuleAsync("productCardStats"),this.$moduleLoader.loadModuleAsync("miniProductCard"),this.$services.userData.getUserDataAsync()]);case 5:o=e.sent,i=_slicedToArray(o,13),s=i[0],a=i[1],d=i[2],l=i[3],c=i[4],u=i[5],h=i[6],p=i[7],m=i[8],v=i[9],f=i[10],y=i[11],b=i[12],Object.assign(this,s),this.colorEvent={openedNm:this.selectedNomenclature.nmId,currentNm:this.selectedNomenclature.nmId},this._updateGoogleTagParams(),this._updateCriterio(),this._sendWbaEventOnColorCarouselClick(this.selectedNomenclature.nmId),g=b.MiniProductCardAdapterHelper.convertFromProductCardViewModel(this),this.miniCard=new b(g,this.$services.userData.userData,this.id,!0),this.statsModel=new y(this.id,this.selectedNomenclature,this.product).init(),this.sizeModel=new d(this.id,this.selectedNomenclature,this.getDeliveryInfoBySize).init(),this.priceModel=new l(this.id,this.selectedNomenclature,this.product,this.statsModel).init(),this.colorsModel=new c(this.id,this.selectedNomenclature,this.product,this.targetInfo,!1).init(),w=new p(this.selectedNomenclature,this.product,this.targetInfo,this.sizeModel,this.priceModel,this.$services.userData.userData,this.analiticState).init(),C=new v("#photo .j-wb-video-player",this.id,this.selectedNomenclature,this.product.adult).init(),this.ponedModel=w,this.orderModel=new u(this.id,this.selectedNomenclature,this.product,this.targetInfo,this.sizeModel,this.priceModel,w).init(),this.deliveryHelper=new h(this.id,this.selectedNomenclature).init(),this.suppliersHelper=null!=a?new a(this.id,this.selectedNomenclature.nmId,this.product.supplierDeliveryInfo,this.statsModel).init():null,this.imageGalleryModel=new m(this.id,this.selectedNomenclature,this.product,w,this.deliveryHelper,C,this.statsModel).init(),this.describtionErrorModel=new f(this.id,this.selectedNomenclature,this.statsModel).init(),this.fromSSR||(this._loadLastData(),this._loadOrdersQnt(),this._loadSearchTags(),this._loadBrandLogo(),this._loadBrandUrl());case 40:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.onAfterRender=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.requestAnimationFrame(function(){document.querySelector(".j-footer").classList.add("footer--padding")}),this._bindEvents(),this.sizeModel.checkSizeList(),window.requestIdleCallback(function(){var e;n.miniCard.init(),n.deliveryHelper.updateAll(),null===(e=n.suppliersHelper)||void 0===e||e.showSupplierInfo(),n.colorsModel.initColorsCarousel(),n.imageGalleryModel.initCarousel(),n.statsModel.onProductOpen(),n.showPriceChartAsync(),n.showOtherSellersAsync(),n._sendViewProductStatistic(),n._saveAsRecentlyViews(),n._fillBigSaleUrl()}),t=this.selectedNomenclature.nmId,r=window.location.hash.substring(1),this.$router.replaceState({selectedNomenclature:t},this._getMetaTagWithPrice(this.metaTags[t].title),window.location.href),this._updateMetaTags(t),this.$adult.proceedIfAdultConfirmed(this.product.adult),""!=r&&this.$moveToAnchor(r);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.onBeforeUnrender=function(){var e,t,r,n,o,i,s,a,d,l,c,u,h,p,m,v,f,y,b;this.unrendered=!0,document.querySelector(".j-footer").classList.remove("footer--padding"),this._unbindEvents(),null===(e=this.feedbacksModel)||void 0===e||e.destroy(),null===(t=this.questionsModel)||void 0===t||t.destroy(),null===(r=this.postsModel)||void 0===r||r.destroy(),null===(n=this.stickyPanel)||void 0===n||n.destroy(),null===(o=this.statCardWba)||void 0===o||null===(i=o.destroy)||void 0===i||i.call(o),null===(s=this.multipleSellersHelper)||void 0===s||s.destroy(),null===(a=this.deliveryHelper)||void 0===a||a.destroy(),null===(d=this.sizeModel)||void 0===d||d.destroy(),null===(l=this.priceModel)||void 0===l||l.destroy(),null===(c=this.colorsModel)||void 0===c||c.destroy(),null===(u=this.suppliersHelper)||void 0===u||u.destroy(),null===(h=this.miniCard)||void 0===h||h.destroy(),null===(p=this.orderModel)||void 0===p||p.destroy(),null===(m=this.imageGalleryModel)||void 0===m||m.destroy(),null===(v=this.priceHistoryHelper)||void 0===v||v.destroy(),null===(f=this.describtionErrorModel)||void 0===f||f.destroy(),null===(y=this.statsModel)||void 0===y||y.destroy(),null===(b=this.ponedModel)||void 0===b||b.destroy()},t.onHistoryChange=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r,n,o,i,s,a,d,l,c,u,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>1&&void 0!==h[1]&&h[1],h.length>2?h[2]:void 0,o=h.length>3?h[3]:void 0,i=window.location.hash.substring(1),s=parseInt(null!==(r=t.selectedNomenclature)&&void 0!==r?r:this.$router.routeParameters.cod1S),this.$services.userData.getUserDataAsync(),a=Number.tryParseInt(this.$router.queryParams.get("size")),null==t.selectedNomenclature&&this.$router.replaceState({selectedNomenclature:s},document.title,window.location.origin+$.views.helpers.productCardUrl(s,a,this.$router.queryParams.get("targetUrl"))),s!=this.selectedNomenclature.nmId){e.next=12;break}return this.$adult.proceedIfAdultConfirmed(this.product.adult),this.$eventBus.dispatchEvent(new CustomEvent("SameProductOpened",{detail:{sourceId:this.id,sourceNmId:this.selectedNomenclature.nmId,selectedSize:a}})),e.abrupt("return");case 12:if(null==(d=this.product.nomenclatures.find(function(e){return e.nmId==s}))||n){e.next=20;break}return e.next=16,this.$services.productCard.loadNomenclature(d,this.product);case 16:return l=e.sent,c={sourceId:this.id,sourceNmId:this.selectedNomenclature.nmId,selectedNomenclature:l,fromPopState:!0},null!=o&&o.aborted||this.$eventBus.dispatchEvent(new CustomEvent("ProductColorChanged",{detail:c})),e.abrupt("return");case 20:return e.prev=20,e.next=23,this.$services.productCard.loadProductCardAsync(s,a);case 23:return u=e.sent,null!=o&&o.aborted||this.$eventBus.dispatchEvent(new CustomEvent("ProductChanged",{detail:_objectSpread({sourceId:this.id,sourceNmId:this.selectedNomenclature.nmId,ancherTarget:i,rating:this.product},u)})),e.abrupt("return");case 28:e.prev=28,e.t0=e.catch(20),wb.popup.renderModalError(e.t0.message);case 31:case"end":return e.stop()}},e,this,[[20,28]])}));return function(t){return e.apply(this,arguments)}}(),t.onActiveViewChanged=function(){var e;null===(e=this.imageGalleryModel)||void 0===e||e.stopVideo()},t.onSamePageNavigation=function(){window.dispatchEvent(new CustomEvent("spaTransition",{detail:{isFinished:!0}})),window.scrollTo(0,0)},t.onSizeUpdated=function(e){var t,r=e.detail,n=r.nmId,o=r.selectedSize;if(this.selectedNomenclature.nmId==n&&o!=(null===(t=this.selectedNomenclature.selectedSize)||void 0===t?void 0:t.characteristicId)){var i=this.selectedNomenclature.sizes.find(function(e){return e.characteristicId===o});if($.observable(this.selectedNomenclature).setProperty("selectedSize",i),"SpaProductCardEntrypoint"===this.$router.currentRoute.name){var s=new URL(window.location.href);i&&s.searchParams.set("size",o),this.$router.replaceState(window.history.state,document.title,s.toString())}}},t.onFavoritesUpdate=function(e){var t=e.detail,r=t.nmId,n=t.isPoned;r==this.selectedNomenclature.nmId&&n&&$.observable(this).setProperty({favedTrigger:Date.now()})},t.onColorChanged=function(e){var t,r,n,o=e.detail,i=o.sourceId,s=o.sourceNmId,a=o.selectedNomenclature,d=o.fromPopState;if(i==this.id&&s==this.selectedNomenclature.nmId){var l=a.nmId;$.observable(this).setProperty({selectedNomenclature:a,showRecommendationCarousel:!1,articlesCount:0,videosCount:0}),null===(t=this.showOtherSellersAsync)||void 0===t||t.call(this),this.showPriceChartAsync(),this.checkArticlesCount(),this.checkVideosCount(),this._fillBigSaleUrl(),this._sendWbaEventOnColorCarouselClick(l),this.colorEvent.currentNm=l,this._sendShownPageStateWba(),!d&&this.$router.addState({selectedNomenclature:l},this._getMetaTagWithPrice(this.metaTags[l].title),$.views.helpers.productCardUrl(l,null,null===(r=this.targetInfo)||void 0===r?void 0:r.targetUrl)),this._sendViewProductStatistic(),null===(n=this._updateMetaTags)||void 0===n||n.call(this,l)}},t.onProductChanged=function(e){var t,r,n,o,i,s=e.detail,a=s.sourceId,d=s.sourceNmId,l=s.ancherTarget,c=_objectWithoutProperties(s,_excluded);if(a==this.id&&this.selectedNomenclature.nmId==d){this.$router.updateCriterio(c.counterEventsModel),window.scrollTo(0,0),this.analiticState=wb.analitics.getState();var u=c.selectedNomenclature.nmId;$.observable(this).setProperty({product:c.product,metaTags:c.metaTags,selectedNomenclature:c.selectedNomenclature,feedbacksModel:null,questionsModel:null,postsModel:null,currentTab:"c",showRecommendationCarousel:!1,articlesCount:0,videosCount:0}),this._loadLastData(),this._loadOrdersQnt(),$.observable(this).setAllProperty(c),$.observable(null!==(t=this.selectedNomenclature.groupedAddedOptions)&&void 0!==t?t:[]).refresh(null!==(r=c.selectedNomenclature.groupedAddedOptions)&&void 0!==r?r:[]),$.observable(null!==(n=this.sitePath)&&void 0!==n?n:[]).refresh(null!==(o=c.sitePath)&&void 0!==o?o:[]),this.showRecommendationCarousel&&$.observable(this).setProperty({showRecommendationCarousel:!1}),this.showPriceChartAsync(),this.showOtherSellersAsync(),this._updateGoogleTagParams(),this._saveAsRecentlyViews(),this._updateCriterio(),this._resetTones(),this._fillBigSaleUrl(),this._sendShownPageStateWba(),null===(i=this._updateMetaTags)||void 0===i||i.call(this,u),this._sendViewProductStatistic(),this._loadSearchTags(),this._loadBrandLogo(),this._loadBrandUrl(),window.dispatchEvent(new CustomEvent("inPlaceFullUpdate",{detail:{isPopupMode:!1}})),this.$adult.proceedIfAdultConfirmed(this.product.adult),null!=l&&""!=l&&this.$moveToAnchor(l)}},t.copyNmId=function(){var e;if(!this.$isDesktop){var t=null!==(e=navigator.clipboard)&&void 0!==e&&e.writeText?navigator.clipboard.writeText(this.selectedNomenclature.nmId):this._copyNmIdFallback();Promise.all([this.$moduleLoader.loadModuleAsync("bottomNotificationPanel"),t]).then(function(e){var t=_slicedToArray(e,1)[0];t.showNotification(t.notificationsType.copyNmId)})}},t._copyNmIdFallback=function(){var e=document.createRange();return e.selectNode(document.getElementById("productNmId")),window.getSelection().removeAllRanges(),window.getSelection().addRange(e),document.execCommand("copy"),window.getSelection().removeAllRanges(),Promise.resolve()},t.showOtherSellersAsync=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.multipleSellersHelper){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.$moduleLoader.loadServiceAsync("multipleSellersService");case 4:return e.next=6,this.$services.multipleSellersService.loadOtherSellersNmIds(this.selectedNomenclature.nmId);case 6:if(t=e.sent,r=t.nmIds,this.unrendered){e.next=14;break}return e.next=11,this.$moduleLoader.loadModuleAsync("multipleSellerHelper");case 11:n=e.sent,$.observable(this).setProperty({multipleSellersHelper:new n(this.id,this.selectedNomenclature,this.product,this.analiticState,this.suppliersHelper).init()}),this.multipleSellersHelper.showOtherSellersAsync(r);case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.showPriceChartAsync=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,o,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=wb.global.settings)&&void 0!==t&&null!==(r=t.switches)&&void 0!==r&&r.enablePriceHistoryChart&&!this.priceHistoryHelper){e.next=2;break}return e.abrupt("return");case 2:return n=this.selectedNomenclature.nmId,e.next=5,this.$services.productCard.loadPriceHistory(n);case 5:if(null==(o=e.sent)||this.unrendered){e.next=12;break}return e.next=9,this.$moduleLoader.loadModuleAsync("priceHistoryChart");case 9:s=e.sent,$.observable(this).setProperty({priceHistoryHelper:new s(this.id,n).init()}),this.priceHistoryHelper.showChartAsync(o,{currentPrice:null===(i=this.priceModel.selectedPrice)||void 0===i?void 0:i.salePrice});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.showSocialSharePopup=function(){var e=this;this.$moduleLoader.loadModuleAsync("productShareHelper").then(function(t){t.showSocialSharePopup(e.selectedNomenclature.nmId,e.product.goodsName,e.product.brandName)})},t.showClaimReportPopup=function(){var e=this;this.$moduleLoader.loadModuleAsync("claimsReporter").then(function(t){e.claimsReporter||(e.claimsReporter=new t),e.claimsReporter.reportClaim(e.selectedNomenclature.nmId)})},t.checkVideosCount=function(){var e=this,t=this.selectedNomenclature.nmId;if(wb.global.settings.switches.enableVideoReviews)return this.$services.productCard.loadProductVideosAsync(this.selectedNomenclature.nmId).then(function(r){var n;if(e.selectedNomenclature.nmId==t){var o=null!==(n=null==r?void 0:r.length)&&void 0!==n?n:0;$.observable(e).setProperty({videosCount:o})}})},t.showVideoReviews=function(){var e=this;if(wb.global.settings.switches.enableVideoReviews){var t=this.selectedNomenclature.nmId;return this.$services.productCard.loadProductVideosAsync(this.selectedNomenclature.nmId).then(function(r){var n;if(!((null!==(n=null==r?void 0:r.length)&&void 0!==n?n:0)<=0))return e.$moduleLoader.loadModuleAsync("videoReviews").then(function(n){var o;e.selectedNomenclature.nmId==t&&(n.data||(n.data={}),n.data.cardCommonActionEventsWba=e.cardCommonActionEventsWba,e.videoReviews=new n(document.getElementById("videoReviewsContainer"),r,n.template,n.data),e.videoReviews.renderAsync(),null===(o=e.statCardWba)||void 0===o||o.sendEvent("Item_Videoreviews_S"))})}).catch(function(e){return!e.isCustomError&&console.error(e.message)})}},t.disposeVideoReviews=function(){var e;null===(e=this.videoReviews)||void 0===e||e.dispose()},t.reportToSupplierService=function(){var e=this;this.$moduleLoader.loadModuleAsync("findOtherSellerPopup").then(function(t){var r,n,o;t.showFindOtherSellersPopup(e.selectedNomenclature.nmId,null!==(r=null===(n=e.multipleSellersHelper)||void 0===n?void 0:null===(o=n.sellersList)||void 0===o?void 0:o.sellers.map(function(e){return e.nmId}))&&void 0!==r?r:[])})},t.digitalLinkClicked=function(e){var t;null===(t=e.currentTarget)||void 0===t||t.dispatchEvent(new Event("mouseout"))},t.getVerifiedCertificateData=function(){return this.selectedNomenclature.verifiedCertificate},t.getAndClickCertificateLink=function(){var e=this;this.selectedNomenclature.verifiedCertificate&&this.$httpClient.fetchBasicJSON(wb.helpers.url.urlCertificateStatic(this.selectedNomenclature.nmId)).then(function(t){t.NmId==e.selectedNomenclature.nmId&&t.url&&Object.assign(document.createElement("a"),{target:"_blank",href:t.url}).click()})},t._loadLastData=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,o,i,s,a,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.selectedNomenclature.nmId,i=this.$router.queryParams.get("targetUrl"),s=new URLSearchParams({subject:this.product.subjectId,kind:this.product.kindId,brand:this.product.brandId}),i&&s.set("targetUrl",i),e.next=6,this.$httpClient.fetchJSON("/webapi/product/".concat(o,"/data?").concat(s.toString()),{},{noProcessResponse:!0}).catch(function(e){return null});case 6:if(a=e.sent,d=null==a?void 0:null===(t=a.value)||void 0===t?void 0:t.data){e.next=10;break}return e.abrupt("return",null);case 10:d.categoryUrl=null===(r=d.sitePath)||void 0===r?void 0:null===(n=r[d.sitePath.length-2])||void 0===n?void 0:n.pageUrl,$.observable(this).setProperty({sitePath:d.sitePath,targetInfo:d.targetInfo}),$.observable(this.product).setProperty({brandAndSubjectUrl:d.brandAndSubjectUrl,categoryUrl:d.categoryUrl}),this.$eventBus.dispatchEvent(new CustomEvent("ProductLastDataRecived",{detail:{sourceId:this.id,sourceNmId:o,lastPart:d}}));case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t._loadOrdersQnt=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.selectedNomenclature.nmId,this.product.nomenclatures){e.next=3;break}return e.abrupt("return");case 3:return r=this.product.nomenclatures.map(function(e){return e.nmId}),e.next=6,this.$httpClient.fetchBasicJSON("https://product-order-qnt.wildberries.ru/by-nm/?nm=".concat(r.join(",")),{credentials:"omit"},{nullOnError:!0});case 6:if(n=e.sent){e.next=9;break}return e.abrupt("return");case 9:this.product.nomenclatures.forEach(function(e){var r=n.find(function(t){return t.nmId===e.nmId});r&&(e.ordersCount=r.qnt),r&&r.nmId===t&&$.observable(o.selectedNomenclature).setProperty({ordersCount:r.qnt})});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t._loadSearchTags=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,o,i,s,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.selectedNomenclature.nmId,e.next=3,this.$user.getUserInfo();case 3:return i=e.sent,e.next=6,this.$httpClient.fetchBasicJSON("https://search-tags.wildberries.ru/tags?nm_id=".concat(o),{credentials:"omit",headers:{UserID:i.uid}},{nullOnError:!0});case 6:if((s=e.sent)&&s.length){e.next=9;break}return e.abrupt("return",null);case 9:a={tagsViewModels:s.map(function(e){return{href:"/catalog/0/search.aspx?search=".concat(e.toSafeString(),"&targeturl=ST&xsearch=true"),text:e,type:1}}),drawType:1,tagsQuery:"C этим товаром искали"},this.searchTags?$.observable(null!==(t=null==this?void 0:null===(r=this.searchTags)||void 0===r?void 0:r.tagsViewModels)&&void 0!==t?t:[]).refresh(null!==(n=null==a?void 0:a.tagsViewModels)&&void 0!==n?n:[]):$.observable(this).setProperty({searchTags:a});case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t._loadBrandLogo=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.product.brandId)?(r=$.views.helpers.forBrandLogoFromId(t),(n=new Image).addEventListener("load",function(){$.observable(o.product).setProperty({brandLogo:r})},!1),n.addEventListener("error",function(){$.observable(o.product).setProperty({brandLogo:null})},!1),n.src=r):$.observable(this.product).setProperty({brandLogo:null});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t._loadBrandUrl=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.views.helpers.brandUrlById(this.product.brandId);case 2:t=e.sent,$.observable(this.product).setProperty({brandUrl:t,brandUrlAll:t?t+"/all":null});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t._resetTones=function(){var e=document.querySelector(".j-colors-list");null!=e&&(e.classList.remove("shown"),e.style.removeProperty("max-height"))},t._sendViewProductStatistic=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,o,i,s,a,d,l,c,u,h,p,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.selectedNomenclature.nmId,n=[this.$stat.wrapParam("GCL",r),this.$stat.wrapParam("TURL",null===(t=this.targetInfo)||void 0===t?void 0:t.targetUrl),this.$stat.wrapParam("REF",this.isPopup?window.location.pathname+window.location.search:this.$router.referrer.replace(/^[^:]+:\/\/[^/]+/,"")),this.$stat.wrapParam("BRID",0),this.$stat.wrapParam("SID",this.product.subjectId)],this.$stat.sendEvent("GCO",n),!window.wba){e.next=12;break}return e.next=6,Promise.all([this._getSellerForStatAsync(),this._getStoreIdForStatAsync()]);case 6:c=e.sent,u=_slicedToArray(c,2),h=u[0],p=u[1],m={id:r,chrt:null===(o=this.miniCard)||void 0===o?void 0:o.characteristicId,name:this.product.goodsName,brand:this.product.brandName,price:(null===(i=this.priceModel.selectedPrice)||void 0===i?void 0:i.salePrice)||0,inListIndex:this.analiticState.iid||1,listName:"".concat(this.analiticState.l,"|","|").concat(this.analiticState.s,"|").concat(null!==(s=this.analiticState.t)&&void 0!==s?s:"","|").concat(null!==(a=this.analiticState.t1)&&void 0!==a?a:"","|").concat(null!==(d=this.analiticState.t2)&&void 0!==d?d:"","|").concat(null!==(l=this.analiticState.t3)&&void 0!==l?l:""),variant:this.selectedNomenclature.colorName,quantity:1,affiliation:h,storeId:p,subjectId:this.product.subjectId,subjectParentId:this.product.subjectParentId},this.$analitic.sendWbaEcomStat("view_item",[m]);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.cardCommonActionEventsWba=function(e){var t;return null===(t=this.statsModel)||void 0===t?void 0:t.cardCommonActionEventsWba(e)},t.cardCommonShowEventsWba=function(e){var t;return null===(t=this.statsModel)||void 0===t?void 0:t.cardCommonShowEventsWba(e)},t._getStoreIdForStatAsync=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null!==(t=this.deliveryHelper)&&void 0!==t&&t.deliveryModelTask?this.deliveryHelper.deliveryModelTask.promise:Promise.resolve(null),e.next=3,r;case 3:return n=e.sent,e.abrupt("return",null==n?void 0:n.storeId);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t._getSellerForStatAsync=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.selectedNomenclature.nmId,null!=this.suppliersHelper){e.next=8;break}return e.next=4,this.$moduleLoader.loadServiceAsync("suppliersService");case 4:return r=this.$services.suppliersService.loadBasicSupplierInfoAsync(t),e.abrupt("return",Promise.resolve(null==r?void 0:r.supplierId));case 8:return e.next=10,this.suppliersHelper.getSuppliersInfo(t);case 10:return o=e.sent,e.abrupt("return",Promise.resolve(null==o?void 0:null===(n=o.suppliersInfo)||void 0===n?void 0:n.supplierId));case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t._updateGoogleTagParams=function(){this.$setGoogleTagsModel(this.googleTagParams)},t._updateCriterio=function(){null!=this.criterioProduct&&(window.CRITEO_CONF=[[{pageType:"product",ProductID:this.criterioProduct.productId,CustomerID:this.criterioProduct.customerId||0,Segment:"0"}],[7389,"pvx","",this.criterioProduct.popup?"000":"010",[[7723445,7723446]],{ProductID:["i",0],CustomerID:["ci",0],Segment:["si",0]}]])},t._saveAsRecentlyViews=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.product.adult){e.next=2;break}return e.abrupt("return");case 2:return $.observable(this).setProperty({renderRecent:!1}),t=this.selectedNomenclature.nmId,this.$recentViews.addProduct(t),r=new URLSearchParams({count:11,cod1S:t}),e.prev=6,e.next=9,this.$httpClient.fetchJSON("/webapi/product/saverecent",{method:"POST",body:r});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),e.t0.isCustomError||console.error(e.t0.message);case 14:return e.prev=14,$.observable(this).setProperty({renderRecent:!0}),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[6,11,14,17]])}));return function(){return e.apply(this,arguments)}}(),t._sendWbaEventOnColorCarouselClick=function(e){var t=this.product.nomenclatures.indexOf(this.colorEvent.currentNm),r=this.product.nomenclatures.indexOf(e);if(window.wba){var n={quantity:t===r?0:r+1,item_id:this.colorEvent.openedNm};this.$analitic.sendEvent(r>t?"Item_Variant_Scroll_Right_T":"Item_Variant_Scroll_Left_T",n)}},t._sendShownPageStateWba=function(){this.$analitic.sendEvent("Screen_V",{name:"Item"})},t._fillBigSaleUrl=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.selectedNomenclature&&!this.selectedNomenclature.bigSaleUrl&&this.selectedNomenclature.panelPromoId){e.next=2;break}return e.abrupt("return");case 2:this.$promotionsHelper.getById(this.selectedNomenclature.panelPromoId).then(function(e){e&&$.observable(t.selectedNomenclature).setProperty({bigSaleUrl:"/promotions/".concat(e.url)})});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t._getReferrerUrl=function(e){try{var t=new URL(this.$productCardHelper.currentProductCardReferrer);return t.hostname==window.location.hostname?t.toString():e}catch(t){return e}},t._bindEvents=function(){this.$eventBus.addEventListener("ProductSizeUpdated",this.onSizeUpdated),this.$eventBus.addEventListener("FavoriteGoodsUpdated",this.onFavoritesUpdate),this.$eventBus.addEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.addEventListener("ProductChanged",this.onProductChanged)},t._unbindEvents=function(){this.$eventBus.removeEventListener("ProductSizeUpdated",this.onSizeUpdated),this.$eventBus.removeEventListener("FavoriteGoodsUpdated",this.onFavoritesUpdate),this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.removeEventListener("ProductChanged",this.onProductChanged)},t._updateMetaTags=function(e){var t=[];t.push({tagName:"title",htmlContent:this._getMetaTagWithPrice(this.metaTags[e].title)}),t.push({tagName:"meta",attributesDictionary:{name:"description",content:this._getMetaTagWithPrice(this.metaTags[e].description)}}),this.$seoHelper.render(t)},t._getMetaTagWithPrice=function(e){var t,r=null!==(t=this.priceModel.selectedPrice)&&void 0!==t&&t.price?"".concat(this.$localziation.forAmount," ").concat($.views.converters.priceWithCurrencyV2(this.priceModel.selectedPrice.salePrice)):"";return e.replace(/%FORPRICE%/,r)},t.switchTab=function(e,t){var r,n,o,i;switch(t.preventDefault(),this.$observable.setProperty({currentTab:e}),this.currentTab){case"q":this.initQuestions(),null===(r=this.statCardWba)||void 0===r||r.sendClickEvent("Item_Question");break;case"p":this.showPostsPreviews(),null===(n=this.statCardWba)||void 0===n||n.sendClickEvent("Item_Article");break;case"c":this.initComments(),null===(o=this.statCardWba)||void 0===o||o.sendClickEvent("Item_Feedback");break;case"v":this.showVideoReviews(),null===(i=this.statCardWba)||void 0===i||i.sendClickEvent("Item_Video");break;default:console.warn("tab is unknown")}return!1},t.checkArticlesCount=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),t.getQuestionsCount=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selectedNomenclature.nmId,e.prev=1,e.next=4,this.$moduleLoader.loadServiceAsync("productQuestionsService");case 4:return e.next=6,this.$services.productQuestionsService.loadQuestionCountAsync(this.product.imtId);case 6:if(r=e.sent,t==this.selectedNomenclature.nmId){e.next=9;break}return e.abrupt("return");case 9:$.observable(this.product).setProperty({questionsCount:r}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0);case 15:case"end":return e.stop()}},e,this,[[1,12]])}));return function(){return e.apply(this,arguments)}}(),t.initComments=function(){var e=this;if("c"==this.currentTab&&null==this.feedbacksModel){var t=this.selectedNomenclature.nmId;this.getQuestionsCount(),this.checkArticlesCount(),this.checkVideosCount(),this.$moduleLoader.loadServiceAsync("productFeedbacksService").then(function(){return Promise.all([e.$services.productFeedbacksService.loadSummaryAndVotes(e.product.imtId,t,30),e.$moduleLoader.loadModuleAsync("productFeedbacksModel"),e.$moduleLoader.loadModuleAsync("summaryModel"),e.$moduleLoader.loadModuleAsync("feedbacksPhotoGallery")])}).then(function(r){var n,o=_slicedToArray(r,4),i=o[0],s=i.summary,a=i.votes,d=o[1],l=o[2],c=o[3];if(t===e.selectedNomenclature.nmId){var u=new l(s,e.selectedNomenclature.showSize),h={imtId:e.product.imtId,nmId:e.selectedNomenclature.nmId,chrtId:null===(n=e.selectedNomenclature.selectedSize)||void 0===n?void 0:n.characteristicId,goodName:e.product.goodsName,brandName:e.product.brandName,adult:e.product.adult},p={feedbacks:s.feedbacks,summaryModel:u},m={votes:a,summary:s},v=new d(e.id,h,p,new c(null==s?void 0:s.photosUris,e.product.adult),m);v.loaded=!0,$.observable(e).setProperty({feedbacksModel:v}),e.$helper.nextTick().then(function(t){e.feedbacksModel.init()})}})}},t.initQuestions=function(){var e=this,t=this.selectedNomenclature.nmId;this.$moduleLoader.loadServiceAsync("productQuestionsService").then(function(){return Promise.all([e.$services.productQuestionsService.loadQuestionsAsync(e.product.imtId,30),e.$moduleLoader.loadModuleAsync("productQuestionsModel"),e.$moduleLoader.loadModuleAsync("questionsEditor"),e.$services.userData.getUserDataAsync()])}).then(function(r){var n,o=_slicedToArray(r,3),i=o[0],s=o[1],a=o[2];if(e.selectedNomenclature.nmId==t){var d=new a(e.product.imtId,e.product.goodsName,e.$services.userData.userData.isAuthenticated,e.selectedNomenclature.nmId),l={imtId:e.product.imtId,nmId:e.selectedNomenclature.nmId,chrtId:null===(n=e.selectedNomenclature.selectedSize)||void 0===n?void 0:n.characteristicId},c=new s(e.id,l,i,d);return $.observable(e).setProperty({questionsModel:c}),e.$helper.nextTick().then(function(){e.questionsModel.init()})}})},t.showPostsPreviews=function(){var e=this,t=this.selectedNomenclature.nmId;return Promise.all([this.$moduleLoader.loadServiceAsync("productArticlesService").then(function(){return e.$services.productArticlesService.loadArticlesAsync(e.selectedNomenclature.nmId)}),this.$moduleLoader.loadModuleAsync("postsModel")]).then(function(r){var n=_slicedToArray(r,2),o=n[0],i=n[1];if(e.selectedNomenclature.nmId==t){var s=new i(e.id,e.nmId,o.posts);$.observable(e).setProperty({postsModel:s}),e.$helper.nextTick().then(function(){e.postsModel.init()})}})},t.showRulesPopup=function(e){return $.views.loadTemplateAsync("CommentGoodRules").then(function(e){wb.popup.showCustomPopup({msg:e(),lockScroll:!0,popupClassesList:["i-popup-comment-rules","shown"],contentClasses:["popup__content"],useCenteredFunction:!0,useHtml:!0})}),!1},t.showCommentPopup=function(){var e;return null===(e=this.feedbacksModel)||void 0===e?void 0:e.showCommentPopup()},_createClass(e,[{key:"getDeliveryInfoBySize",get:function(){var e=this;return{getDeliveryInfo:function(t){var r,n;return null===(r=(n=e.deliveryHelper).getByChrtId)||void 0===r?void 0:r.call(n,t)}}}},{key:"showRecommendationCarousel",get:function(){return this._showRecommendationCarousel},set:function(e){var t=this;this._showRecommendationCarousel=e,e||setTimeout(function(){return $.observable(t).setProperty({showRecommendationCarousel:!0})},50)}}]),e}();wb.spa.registerViewModel(e)}();

},{}]},{},[1]);
