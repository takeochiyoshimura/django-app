(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var FRAME_OFFSET=1e3/60,FRAMES_IN_MLS=200/FRAME_OFFSET,SupplierInfoModel=function(e){function t(t){var r;return r=e.call(this)||this,t?(r.nmId=t.nmId,r.legalAddress=t.legalAddress,r.ogrn=t.ogrn,r.ogrnip=t.ogrnip,r.supplierName=t.supplierName,r.trademark=t.trademark,r.dt=t.dt,r.supplierId=t.supplierId,r.showPharmaLink=[225188,181237,313828,231062,236960].includes(t.supplierId),r.isDefaultSupplier=t.isDefaultSupplier,r.orgForms=t.orgForms,r.shopName=t.shopName,r.logoUrl=t.logoUrl,r.shopId=t.shopId,r):(r.isDefaultSupplier=!0,_assertThisInitialized(r))}_inheritsLoose(t,e);var r=t.prototype;return r.sendClickEvent=function(){this.$analitic.sendEvent("Item_Supplier_T",{name:this.supplierName,id:this.supplierId,type:"fullsize"}),this.$analitic.proceedAndSave("ISC")},r.scrollDetails=function(e){var t=e.currentTarget,r=e.clientX,o=t.scrollLeft,n=function(e){var n=e.clientX-r;t.scrollLeft=o-n};document.addEventListener("mousemove",n),document.addEventListener("mouseup",function e(){document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",e);var r=t.scrollWidth-t.clientWidth,o=0,i=t.childNodes.toArray().find(function(e){return(o+=e.offsetWidth)>t.scrollLeft}),s=((o-t.scrollLeft)/i.offsetWidth<.5||r==t.scrollLeft?Math.min(o,r):Math.max(o-i.offsetWidth,0))-t.scrollLeft;window.requestAnimationFrame(function(){return customScrollSnap(t,s,s/FRAMES_IN_MLS)})})},t}(WbSpaModel);function customScrollSnap(e,t,r){Math.abs(r)-Math.abs(t)>=0||(t-=r,e.scrollBy(r,0),window.requestAnimationFrame(function(){return customScrollSnap(e,t,r)}))}module.exports=SupplierInfoModel;

},{}],2:[function(require,module,exports){
"use strict";function asyncGeneratorStep(e,t,n,r,s,i,o){try{var u=e[i](o),a=u.value}catch(e){return void n(e)}u.done?t(a):Promise.resolve(a).then(r,s)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise(function(r,s){var i=e.apply(t,n);function o(e){asyncGeneratorStep(i,r,s,o,u,"next",e)}function u(e){asyncGeneratorStep(i,r,s,o,u,"throw",e)}o(void 0)})}}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(){var e=require("./supplierInfo"),t=function(){function t(e,t,n,r){this.parentId=e,this.nmId=t,this.deliveryInfo=n,this.statsModel=r,this.currentSupplier={},this.onColorChanged=this.onColorChanged.bind(this),this.onProductChanged=this.onProductChanged.bind(this)}t.loadTooltipTemplateAsync=function(){return $.views.loadTemplateAsync("suppliersInfoTooltipster")};var n=t.prototype;return n.init=function(){return this._bindEvents(),this},n.destroy=function(){return this._unbindEvents(),this},n.onColorChanged=function(e){var t=e.detail,n=t.sourceId,r=t.sourceNmId,s=t.selectedNomenclature;n==this.parentId&&r==this.nmId&&(this.nmId=s.nmId,this.showSupplierInfo())},n.onProductChanged=function(e){var t=e.detail,n=t.sourceId,r=t.sourceNmId,s=t.product,i=t.selectedNomenclature;this.parentId==n&&this.nmId==r&&(this.deliveryInfo=s.supplierDeliveryInfo,this.nmId=i.nmId,this.showSupplierInfo())},n.showSupplierInfo=function(){return this._setSuppliersInfoAsync(this.nmId,this.deliveryInfo)},n.getSuppliersInfo=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastSupplierInfoRequestKey==t&&this.lastSupplierInfoRequestTask||(this.lastSupplierInfoRequestKey=t,this.lastSupplierInfoRequestTask=this._getSuppliersInfo(t,n)),e.next=3,this.lastSupplierInfoRequestTask;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n._getSuppliersInfo=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(n,r){var s,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r||(r=this.deliveryInfo),t.next=3,this.$moduleLoader.loadServiceAsync("suppliersService");case 3:return t.next=5,this.$services.suppliersService.loadBasicSupplierInfoAsync(n);case 5:if(s=t.sent,i=new e(s),o=null,null==i){t.next=12;break}return t.next=11,this.$services.suppliersService.getSupplierExtInfo(i.supplierId,r);case 11:o=t.sent;case 12:return t.abrupt("return",Promise.resolve({suppliersInfo:i,extInfo:o}));case 13:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),n._setSuppliersInfoAsync=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t,n){var r,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSuppliersInfo(t,n);case 2:return r=e.sent,s=r.suppliersInfo,i=r.extInfo,null!=s&&(this.statsModel&&(this.statsModel.sendEvent("Item_Seller_Info_S"),s.showPharmaLink&&this.statsModel.sendEvent("Item_Medical_Info_S")),$.observable(this).setProperty({currentSupplier:s}),i&&$.observable(this.currentSupplier).setProperty("extInfo",i)),e.abrupt("return",Promise.resolve(this.currentSupplier));case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),n._bindEvents=function(){this.$eventBus.addEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.addEventListener("ProductChanged",this.onProductChanged)},n._unbindEvents=function(){this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.removeEventListener("ProductChanged",this.onProductChanged)},_createClass(t,[{key:"template",get:function(){return t.template}}]),t}();window.__spaModuleManager__.register("suppliersInfoHelper",t)}();

},{"./supplierInfo":1}]},{},[2]);
