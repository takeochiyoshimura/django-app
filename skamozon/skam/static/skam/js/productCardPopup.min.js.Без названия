(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,_setPrototypeOf(e,r)}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(n=t.next()).done)&&(a.push(n.value),!r||a.length!==r);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(s)throw o}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,r,t,n,o,a,i){try{var s=e[a](i),u=s.value}catch(e){return void t(e)}s.done?r(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise(function(n,o){var a=e.apply(r,t);function i(e){asyncGeneratorStep(a,n,o,i,s,"next",e)}function s(e){asyncGeneratorStep(a,n,o,i,s,"throw",e)}i(void 0)})}}!function(){var e=WbSpaModel.prototype.$services,r=WbSpaModel.prototype.$moduleLoader,t=WbSpaModel.prototype.$localziation,n=WbSpaModel.prototype.$helper,o=function(){function o(){}return o.show=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(i,s,u,c,l){var d,p,f,y,h,v,b;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.onHide=l,n.prev=1,n.next=4,Promise.all([e.productCard.loadProductCardAsync(parseInt(i),s),r.loadModuleAsync("productPopupViewModel")]);case 4:return d=n.sent,p=_slicedToArray(d,2),f=p[0],y=p[1],h=new y(f),v=new a(h),n.next=12,v.onBeforeRender();case 12:o.showPopup(v,l),n.next=22;break;case 15:if(n.prev=15,n.t0=n.catch(1),b=n.t0.message,n.t0.isCustomError||(console.error(n.t0.message),b=t.serverError),!n.t0.isNotFound){n.next=21;break}return n.abrupt("return");case 21:wb.popup.renderModalError(b);case 22:case"end":return n.stop()}},n,this,[[1,15]])}));return function(e,r,t,o,a){return n.apply(this,arguments)}}(),o.showSlider=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(i,s,u){var c,l,d,p,f,y,h,v,b,w,m,_;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c=i.cod1S,l=i.chrtId,i.newTargetUrl,d=i.onSlideMove,p=i.onHideCallback,f=i.disableFullButton,n.prev=1,n.next=4,Promise.all([e.productCard.loadProductCardAsync(parseInt(c),l),r.loadModuleAsync("productPopupViewModel")]);case 4:return y=n.sent,h=_slicedToArray(y,2),v=h[0],b=h[1],w=new b(v,f),m=new a(w,!0,s,u,d),n.next=12,m.onBeforeRender();case 12:o.showPopup(m,p),n.next=22;break;case 15:if(n.prev=15,n.t0=n.catch(1),_=n.t0.message,n.t0.isCustomError||(console.error(n.t0.message),_=t.serverError),!n.t0.isNotFound){n.next=21;break}return n.abrupt("return");case 21:wb.popup.renderModalError(_);case 22:case"end":return n.stop()}},n,null,[[1,15]])}));return function(e,r,t){return n.apply(this,arguments)}}(),o.showPopup=function(e,r){var t=this;wb.popup.showCustomPopup({useHtml:!0,popupClassesList:["i-popup-same-part-kt","j-product-popup","shown"],contentClasses:["content"],useCenteredFunction:!0,lockScroll:!0,onShow:function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function r(o){var a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e.template.link(o.querySelector(".content"),e),r.next=3,n.nextTick();case 3:e.onAfterRender(),null===(a=t.onShow)||void 0===a||a.call(t);case 5:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}(),onHide:function(){try{e.onBeforeUnrender(),null==r||r()}catch(e){}}})},o}(),a=function(e){function r(r){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return(t=e.call(this)||this).productViewModel=r,t.showSlider=n,t.allCards=o,t.currentIndex=a,t.onSlideMove=i,t._keyEvents=t._keyEvents.bind(_assertThisInitialized(t)),t}_inheritsLoose(r,e);var t=r.prototype;return t.onBeforeRender=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.productViewModel.onBeforeRender();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.onAfterRender=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._bindEvents(),e.next=3,this.productViewModel.onAfterRender();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.onBeforeUnrender=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._unbindEvents(),e.next=3,this.productViewModel.onBeforeUnrender();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.moveToNextSlide=function(e){var r,t,n=this;this.currentIndex=(this.currentIndex+e)%this.allCards.length,this.currentIndex<0&&(this.currentIndex+=this.allCards.length);var o=this.allCards[this.currentIndex];if("true"==o.dataset.isService)return this.moveToNextSlide(e);var a=o.dataset.analiticsCode,i=o.dataset.extraAnaliticsCode,s=null!==(r=o.dataset.analiticsIid)&&void 0!==r?r:this.currentIndex+1,u=s?{extraL:i,iid:s}:null;a&&(u.l=a),u&&this.$analitic.updateState(u);var c=parseInt(o.dataset.nmId||o.dataset.popupNmId);null===(t=this.onSlideMove)||void 0===t||t.call(this,c),this.$services.productCard.loadProductCardAsync(c).then(function(e){n.$eventBus.dispatchEvent(new CustomEvent("ProductChanged",{detail:_objectSpread({sourceId:n.productViewModel.id,sourceNmId:n.productViewModel.selectedNomenclature.nmId},e)}))})},t._bindEvents=function(){window.addEventListener("keydown",this._keyEvents)},t._unbindEvents=function(){window.removeEventListener("keydown",this._keyEvents)},t._keyEvents=function(e){39==e.keyCode?this.moveToNextSlide(1):37==e.keyCode&&this.moveToNextSlide(-1)},_createClass(r,[{key:"template",get:function(){return o.template}}]),r}(WbSpaModel);window.__spaModuleManager__.register("productCardPopup",o)}();

},{}]},{},[1]);
