(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep(e,t,r,n,o,i,s){try{var a=e[i](s),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(e){asyncGeneratorStep(i,n,o,s,a,"next",e)}function a(e){asyncGeneratorStep(i,n,o,s,a,"throw",e)}s(void 0)})}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(){var e=function(){function e(e,t,r,n,o){var i;this.id=this.$generateGuid(),this.parentId=e,this.nmId=t.nmId,this.colorSetName=t.colorSetName,this.colorName=t.colorName,this.showSize=t.showSize,this.nomenclatures=null!==(i=r.nomenclatures)&&void 0!==i?i:[],this.adult=r.adult,this.targetInfo=n,this.product=r,this.isPopup=o,this.onColorChanged=this.onColorChanged.bind(this),this.onProductChanged=this.onProductChanged.bind(this)}var t=e.prototype;return t.init=function(){return this._bindEvents(),this},t.destroy=function(){var e;return this._unbindEvents(),null===(e=this.swiper)||void 0===e||e.destroy(),this.nomenclatures.forEach(function(e){var t;return null===(t=e.miniCarousel)||void 0===t?void 0:t.stop()}),this},t.onColorChanged=function(e){var t=e.detail,r=t.sourceId,n=t.sourceNmId,o=t.selectedNomenclature;r==this.parentId&&n==this.nmId&&$.observable(this).setProperty({nmId:o.nmId,colorSetName:o.colorSetName,colorName:o.colorName,showSize:o.showSize})},t.onProductChanged=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r,n,o,i,s,a,u,d=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.detail,o=n.sourceId,i=n.sourceNmId,s=n.selectedNomenclature,a=n.product,u=n.targetInfo,o==this.parentId&&this.nmId==i){e.next=3;break}return e.abrupt("return");case 3:return this.nomenclatures.forEach(function(e){var t;return null===(t=e.miniCarousel)||void 0===t?void 0:t.stop()}),$.observable(this).setProperty({nmId:s.nmId,colorSetName:s.colorSetName,colorName:s.colorName,showSize:s.showSize,adult:a.adult,targetInfo:u}),$.observable(this.nomenclatures).refresh(null!==(r=a.nomenclatures)&&void 0!==r?r:[]),this.product=a,e.next=9,this.$helper.nextTick();case 9:window.requestAnimationFrame(function(){d.swiper.update(),d.swiper.slideTo(0,0)});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.initColorsCarousel=function(){var e,t=document.getElementById(this.id);this.swiper=new Swiper(t,(_defineProperty(e={slidesPerView:this.isPopup?4:"auto",spaceBetween:8,watchOverflow:!0,updateOnWindowResize:!0,navigation:{nextEl:t.parentNode.querySelector(".swiper-button-next"),prevEl:t.parentNode.querySelector(".swiper-button-prev"),disabledClass:"disabled",lockClass:"hide"}},this.isPopup?null:"breakpoints",{1024:{slidesPerView:4},1504:{slidesPerView:5},1600:{slidesPerView:4}}),_defineProperty(e,"on",{init:function(){t.classList.remove("carousel-opacity")}}),e))},t.updateNomenclature=function(e){var t=$.view(e.currentTarget).data;t&&(null==e||e.preventDefault(),null==e||e.stopPropagation(),null==e||e.stopImmediatePropagation(),this.$adult.proceedIfAdultConfirmed(this.product.adult,this._updateNomenclature,this,t,!1,e))},t.showMiniCarousel=function(e){var t=this,r=e.currentTarget,n=$.view(r).data;!n||this.adult&&!this.$adult.isConfirmed||(n.miniCarousel?Promise.resolve(n.miniCarousel):this.$moduleLoader.loadModuleAsync("miniCardCarousel").then(function(e){if(n.miniCarousel)return Promise.resolve(n.miniCarousel);var r=new e({adult:t.product.adult,nmId:n.nmId,sizes:n.sizes.map(function(e){return{unavailable:e.isSoldOut,ch:e.characteristicId,nm:e.sizeName}}),woSize:!t.showSize,brand:t.product.brandName,name:t.product.goodsName,soldOut:n.price.soldOut,enabledForRegion:n.price.enabledForRegion,priceDiff:n.price.priceDiff,salePrice:n.price.salePrice,price:n.price.price,pics:n.picsCount});return $.observable(n).setProperty({miniCarousel:r}),Promise.resolve(n.miniCarousel)})).then(function(o){r.matches(":hover")&&(null==o?void 0:o.positionAt(e.currentTarget))&&t.nomenclatures.forEach(function(e){var t;return e!=n&&(null===(t=e.miniCarousel)||void 0===t?void 0:t.stop())})})},t.hideMiniCarousel=function(e){var t,r=$.view(e.currentTarget).data;r&&(null===(t=r.miniCarousel)||void 0===t||t.stop())},t._updateNomenclature=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$services.productCard.loadNomenclature(t,this.product);case 2:r=e.sent,n={sourceId:this.parentId,sourceNmId:this.nmId,selectedNomenclature:r},this.$eventBus.dispatchEvent(new CustomEvent("ProductColorChanged",{detail:n}));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t._bindEvents=function(){this.$eventBus.addEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.addEventListener("ProductChanged",this.onProductChanged)},t._unbindEvents=function(){this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChanged),this.$eventBus.removeEventListener("ProductChanged",this.onProductChanged)},_createClass(e,[{key:"template",get:function(){return e.template}}]),e}();window.__spaModuleManager__.register("productCardColors",e)}();

},{}]},{},[1]);
